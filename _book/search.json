[{"path":"index.html","id":"mínimos-cuadrados-ordinarios","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1 Mínimos Cuadrados Ordinarios","text":"","code":""},{"path":"index.html","id":"el-problema","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.1 El problema","text":"Recordando que el método de MCO resulta en encontrar la combinación de valores de los estimadores de los parámetros \\(\\hat{\\boldsymbol{\\beta}}\\) que permita minimizar la suma de los residuales (estimadores de los términos de erro \\(\\boldsymbol{\\varepsilon}\\)) al cuadrado dada por:\\[\n    \\sum^{N}_{=1}{e^2_i} = \\sum^{N}_{= 1}{(y_i - \\mathbf{X}'_i \\hat{\\boldsymbol{\\beta}})^2}\n\\]Donde \\(\\hat{\\boldsymbol{\\beta}}\\) denota el vector de estimadores \\(\\hat{\\beta}_1, \\ldots, \\hat{\\beta}_K\\) y dado que \\((e_1, e_2, \\ldots, e_n)'(e_1, e_2, \\ldots, e_n) = {\\mathbf{e'e}}\\), el problema del método de MCO consiste en resolver el problema de óptimización:\\[\\begin{eqnarray*}\nMinimizar_{\\hat{\\boldsymbol \\beta}} S(\\hat{\\boldsymbol \\beta})  =  Minimizar_{\\hat{\\boldsymbol \\beta}} \\mathbf{e'e} \\\\\n    =  Minimizar_{\\hat{\\boldsymbol \\beta}} (\\mathbf{Y}-\\mathbf{X}\\hat{\\boldsymbol \\beta})'(\\mathbf{Y}-\\mathbf{X}\\hat{\\boldsymbol \\beta})\n\\end{eqnarray*}\\]Expandiendo la expresión \\(\\mathbf{e'e}\\) obtenemos:\n\\[\n    \\mathbf{e'e} = \\mathbf{Y'Y} - 2 \\mathbf{Y'X} \\hat{\\boldsymbol \\beta} + \\hat{\\boldsymbol \\beta}' \\mathbf{X'X}\\hat{\\boldsymbol \\beta}\n\\]De esta forma obtenemos que las condiciones necesarias de un mínimo son:\\[\n    \\frac{\\partial S(\\hat{\\boldsymbol \\beta})}{\\partial \\hat{\\boldsymbol \\beta}} = -2{\\mathbf{X'Y}} + 2{\\mathbf{X'X}} \\hat{\\boldsymbol{\\beta}} = \\mathbf{0}\n\\]\nY se pueden despejar las dadas por:Debido que el objetivo es encontrar la matriz \\(\\hat{\\boldsymbol\\beta}\\) despejamos:\\[\\hat{\\boldsymbol \\beta} = (\\mathbf{X'X})^{-1}\\mathbf{X'Y}\n\\]\n\\[\n    \\mathbf{X'X}\\hat{\\boldsymbol \\beta} = \\mathbf{X'Y}\n\\]","code":""},{"path":"index.html","id":"estimación-r","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.2 Estimación R","text":"Para la estimación utilizaremos el paquete “BatchGetSymbols”. Este paquete nos permitirá descargar información acerca de la bolsa de valores internacional.","code":""},{"path":"index.html","id":"dependencias","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.2.1 Dependencias","text":"","code":"\n#install.packages(\"pacman\")\n#pacman nos permite cargar varias librerias en una sola línea\nlibrary(pacman)\npacman::p_load(tidyverse,BatchGetSymbols,ggplot2, lubridate)"},{"path":"index.html","id":"descarga-de-los-valores","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.2.2 Descarga de los valores","text":"","code":"\n#Primero determinamos el lapso de tiempo\npd<-Sys.Date()-365 #primer fecha\npd\n#> [1] \"2021-09-18\"\nld<-Sys.Date() #última fecha\nld\n#> [1] \"2022-09-18\"\n#Intervalos de tiempo\nint<-\"monthly\"\n#Datos a elegir\ndt<-c(\"AMZN\")\n\n#Descargando los valores\n?BatchGetSymbols()\ndata<- BatchGetSymbols(tickers = dt,\n                       first.date = pd,\n                       last.date = ld,\n                       freq.data = int,\n                       do.cache = FALSE,\n                       thresh.bad.data = 0)\n\n#Generando data frame con los valores\ndata_precio<-data$df.tickers\ncolnames(data_precio)\n#>  [1] \"ticker\"              \"ref.date\"           \n#>  [3] \"volume\"              \"price.open\"         \n#>  [5] \"price.high\"          \"price.low\"          \n#>  [7] \"price.close\"         \"price.adjusted\"     \n#>  [9] \"ret.adjusted.prices\" \"ret.closing.prices\""},{"path":"index.html","id":"gráficas","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.2.3 Gráficas","text":"","code":"\nsp_precio<-ggplot(data_precio, aes(x=ref.date, y=price.open))+geom_point(size =2, colour = \"black\")+labs(x=\"Fecha\", y=\"Precio de apertura (USD)\", title=\"Precio de apertura de AMZN en el ultimo año\")+ theme_light()+ geom_smooth(method = lm, se = TRUE)\nsp_precio\n\nsp_volumen<-ggplot(data_precio, aes(x=ref.date, y=volume))+geom_point(size =2, colour = \"black\")+labs(x=\"Fecha\", y=\"Volumen\", title=\"Volumenes de AMZN en el ultimo año\")+ theme_light()+ geom_smooth(method = lm, se = TRUE)\nsp_volumen"},{"path":"index.html","id":"regresión-lineal-que-optiene-los-coeficientes-hatboldsymbol-beta","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.2.4 Regresión lineal que optiene los coeficientes \\(\\hat{\\boldsymbol \\beta}\\)","text":"","code":"\n#datos estadísticos\nsummary(data_precio[c(\"price.open\",\"volume\")])\n#>    price.open        volume         \n#>  Min.   :106.3   Min.   :5.565e+08  \n#>  1st Qu.:126.0   1st Qu.:1.273e+09  \n#>  Median :152.7   Median :1.465e+09  \n#>  Mean   :148.1   Mean   :1.393e+09  \n#>  3rd Qu.:167.6   3rd Qu.:1.628e+09  \n#>  Max.   :177.2   Max.   :2.258e+09\n#análisis de regresión lineal lm() y=precio,x=fecha\nreg_tiempo_precio<-lm(price.open~ref.date, data=data_precio) \n#¡Siempre se pone dentro de lm() la variable dependiente primero y luego la independiete!\nsummary(reg_tiempo_precio)\n#> \n#> Call:\n#> lm(formula = price.open ~ ref.date, data = data_precio)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -21.983  -9.331  -0.524   9.438  20.707 \n#> \n#> Coefficients:\n#>               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept) 3324.56599  626.77652   5.304 0.000251 ***\n#> ref.date      -0.16670    0.03289  -5.068 0.000362 ***\n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 13.19 on 11 degrees of freedom\n#> Multiple R-squared:  0.7001, Adjusted R-squared:  0.6729 \n#> F-statistic: 25.68 on 1 and 11 DF,  p-value: 0.0003617\n\n#análisis de regresión lineal lm() y=volumen,x=fecha\nreg_tiempo_volumen<-lm(volume~ref.date, data=data_precio)\nsummary(reg_tiempo_volumen)\n#> \n#> Call:\n#> lm(formula = volume ~ ref.date, data = data_precio)\n#> \n#> Residuals:\n#>        Min         1Q     Median         3Q        Max \n#> -802839208  -87783792   63911983  235749891  849020075 \n#> \n#> Coefficients:\n#>               Estimate Std. Error t value Pr(>|t|)\n#> (Intercept) -3.745e+09  2.221e+10  -0.169    0.869\n#> ref.date     2.697e+05  1.165e+06   0.231    0.821\n#> \n#> Residual standard error: 467500000 on 11 degrees of freedom\n#> Multiple R-squared:  0.004844,   Adjusted R-squared:  -0.08563 \n#> F-statistic: 0.05354 on 1 and 11 DF,  p-value: 0.8213"},{"path":"index.html","id":"ejercicio","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.3 Ejercicio","text":"El objetivo de este ejrcicio es simplemente que indiquen y modifiquen los errores en el código. Así pues, deberán descomentar -quitar las #antes del código- para empezar el ejercicio.","code":""},{"path":"index.html","id":"section","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.3.1 1","text":"El objetivo de este código es explicar la variable “volume” con la variable “price.high”.","code":"\n#reg_tiempo_ej1<-lm(price.high~volume, data=data_precio)\n#sumary(reg_tiempo_ej1)"},{"path":"index.html","id":"section-1","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.3.2 2","text":"El objetivo de este código es explicar la variable “volume” con la variable “price.low”.","code":"\n#reg_tiempo_ej2<-lm(price.low~volume, data=data_precio)\n#summary(reg_tiempo_ej1)"},{"path":"index.html","id":"opcional","chapter":"1 Mínimos Cuadrados Ordinarios","heading":"1.3.3 3 (opcional)","text":"El objetivo de este ejercicio es descargar los valores del stock de Tesla BMV: TSLA en los últimos dos años.","code":"\n#dt_ej3<-(\"TSLA\")\n#pdej<-Sys.Date()-(365*3) #primer fecha\n#pdej\n#Descargando los valores\n#dataej3<- BatchgetSymbols(tickers = dt_ej3,\n                       #first.date = pdej,\n                       #last.date = ld,\n                       #freq.data = int,\n                       #do.cache = FALSE,\n                       #thresh.bad.data = 0)\n\n#Generando data frame con los valores\n#data_precio_ej2<-dataej3$df.tickers\n#1colnames(data_precio_ej2)"},{"path":"máxima-verosimilitud.html","id":"máxima-verosimilitud","chapter":"2 Máxima Verosimilitud","heading":"2 Máxima Verosimilitud","text":"","code":""},{"path":"máxima-verosimilitud.html","id":"el-problema-1","chapter":"2 Máxima Verosimilitud","heading":"2.1 El problema","text":"Recordemos que dado \\(f(y_i | \\mathbf{x}_i)\\) la función de densidad condicional de \\(y_i\\) dado \\(\\mathbf{x}_i\\). Sea \\(\\boldsymbol{\\theta}\\) un conjunto de parámetros de la función. Entonces la función de densidad conjunta de variables aleatorias independientes \\(\\{ y_i : y_i \\\\mathbb{R} \\}\\) dados los valores \\(\\{ \\mathbf{x}_i : \\mathbf{x}_i \\\\mathbb{R}^K \\}\\) estará dada por:\\[\\begin{equation}\n    \\Pi_{= 1}^{n} f(y_i | \\mathbf{x}_i; \\boldsymbol{\\theta}) = f(y_1, y_2, \\ldots, y_n | \\mathbf{x}_1, \\mathbf{x}_2, \\ldots, \\mathbf{x}_n; \\boldsymbol{\\theta}) = L(\\boldsymbol{\\theta})\n    \\tag{2.1}\n\\end{equation}\\]la ecuación (2.1) se le conoce como ecuación de verosimilitud. El problema de máxima verosimilitud entonces será:\n\\[\\begin{equation}\n    \\max_{\\boldsymbol{\\theta} \\\\boldsymbol{\\Theta}} \\Pi_{= 1}^{n} f(y_i | \\mathbf{x}_i; \\boldsymbol{\\theta}) = \\max_{\\boldsymbol{\\theta} \\\\boldsymbol{\\Theta}} L(\\boldsymbol{\\theta})\n        \\tag{2.2}\n\\end{equation}\\]Dado que el logaritmo natural es una transformación monotona, podemos decir que el problema de la ecuación (2.2) es equivalente :\\[\\begin{equation}\n     \\max_{\\boldsymbol{\\theta} \\\\boldsymbol{\\Theta}} ln L(\\boldsymbol{\\theta}) = \\max_{\\boldsymbol{\\theta} \\\\boldsymbol{\\Theta}} ln \\Pi_{= 1}^{n} f(y_i | \\mathbf{x}_i; \\boldsymbol{\\theta}) = \\max_{\\boldsymbol{\\theta} \\\\boldsymbol{\\Theta}} \\sum_{= 1}^{n} ln f(y_i | \\mathbf{x}_i; \\boldsymbol{\\theta})\n            \\tag{2.3}\n\\end{equation}\\]Para solucionnar el problema se tiene que determinar las condicones de primer y segundo orden, las cuales serán:\n\\[\\begin{equation}\n    \\frac{\\partial}{\\partial \\boldsymbol{\\theta}} ln L(\\boldsymbol{\\theta}) = \\nabla ln L(\\boldsymbol{\\theta})\n          \\tag{2.4}\n\\end{equation}\\]\\[\\begin{equation}\n    \\frac{\\partial^2}{\\partial^2 \\boldsymbol{\\theta}} ln L(\\boldsymbol{\\theta}) = \\frac{\\partial}{\\partial \\boldsymbol{\\theta}} ln L(\\boldsymbol{\\theta}) \\cdot  \\frac{\\partial}{\\partial \\boldsymbol{\\theta}} ln L(\\boldsymbol{\\theta}') = H(\\boldsymbol{\\theta})\n             \\tag{2.5}\n\\end{equation}\\]La solución estará dada por aquel valor de \\(\\hat{\\boldsymbol{\\theta}}\\) que hace:\n\\[\\begin{equation*}\n    \\frac{\\partial}{\\partial \\boldsymbol{\\theta}} ln L(\\hat{\\boldsymbol{\\theta}}) = 0\n\\end{equation*}\\]su vez, la varianza será aquella que resulta de:\n\\[\\begin{equation*}\n    Var[\\hat{\\boldsymbol{\\theta}} | \\mathbf{X}] = \\left( - \\mathbb{E}_{\\hat{\\boldsymbol{\\theta}}}[H(\\boldsymbol{\\theta})] \\right)^{-1}\n\\end{equation*}\\]","code":""},{"path":"máxima-verosimilitud.html","id":"estimación-y-simunlación","chapter":"2 Máxima Verosimilitud","heading":"2.2 Estimación y simunlación","text":"","code":""},{"path":"máxima-verosimilitud.html","id":"lanzar-una-moneda","chapter":"2 Máxima Verosimilitud","heading":"2.2.1 Lanzar una moneda","text":"Si bien el ejercicio anterior es un tanto repetitivo debido que sabemos que hay un 50% de que caiga una moneda de un lado o otro. Esto ejemplifica la manera en la que se utiliza el metodo de maximización de máxima verosimilitud.","code":"\nset.seed(1234)#esto sirve para siempre generar los mismos numeros aleatorios\n#rbinom(numero observaciones,numero de ensayos,probabilidad de exito en cada ensayo)\ncara<-rbinom(1,100,0.5)\ncara#esto nos dice de los 100 ensayos cuantos fueron cara\n#> [1] 47\nsol<-100-cara\nsol\n#> [1] 53\n\n\n#Ahora definiremos la función que encontrará la función de verosimilutud para determinado valor p\n#\nverosimilitud <- function(p){\n  dbinom(cara, 100, p)\n}\n\n#si suponemos que la probabilidad sesgada de que caiga cara es 40%\nprob_sesgada<-0.4\n#es posible calcular la función de que salga cara\nverosimilitud(prob_sesgada)\n#> [1] 0.02919091\n#ahora es posible generar una función de verimilitud negativa \n#para maximizar el valor de la verosimilitud\nneg_verosimilitud <- function(p){\n  dbinom(cara, 100, p)*-1\n}\nneg_verosimilitud(prob_sesgada)\n#> [1] -0.02919091\n# unamos la función nlm() para maximizar esta función no linear\n#?nlm()\nnlm(neg_verosimilitud,0.5,stepmax=0.5)#se pone un parametro porque sabemos que hay un 0.5 de probabilidad de que caiga cara\n#> $minimum\n#> [1] -0.07973193\n#> \n#> $estimate\n#> [1] 0.47\n#> \n#> $gradient\n#> [1] 1.589701e-10\n#> \n#> $code\n#> [1] 1\n#> \n#> $iterations\n#> [1] 4"},{"path":"método-generalizado-de-momentos-mgm.html","id":"método-generalizado-de-momentos-mgm","chapter":"3 Método Generalizado de Momentos (MGM)","heading":"3 Método Generalizado de Momentos (MGM)","text":"","code":""},{"path":"método-generalizado-de-momentos-mgm.html","id":"el-problema-2","chapter":"3 Método Generalizado de Momentos (MGM)","heading":"3.1 El problema","text":"Retomemos el modelo de regresión lineal tal que:\\[\\begin{equation}\ny_i=X_i\\beta+u_i\n    \\label{Eq_reglin}\n\\end{equation}\\]Tomando en cuenta los principios de ortogonalidad (\\(E(Z_iu_i)=0\\)) y (\\(rankE(Z_i^{'}X_i)=0\\)) sabemos que \\(\\beta\\) es el único vector de \\(N\\times1\\) que resuelve las condiciones de momento de determinada población. En otras palabras, \\(E[z_i^{'}(y_i-x_i\\beta)]=0\\) es una solución y \\(E[z_i^{'}(y_i-x_i\\beta)]\\neq0\\) es una solución. Debido que la media muestral son estimadores consistentes de momentos de una población, se puede:\\[\\begin{equation}\nN^{-1}\\sum_{=1}^{N}z_i^{'}(y_i-x_i\\beta)=0\n\\tag{3.1}\n\\end{equation}\\]Asumiendo que la ecuación (3.1) tiene L ecuaciones lineales y K coeficientes \\(\\beta\\) desconocidos y \\(K=L\\), entonces la matriz \\(\\sum_{=1}^{N}z_i^{'}x_i\\) debe ser singular para encontrar los coeficientes de la siguiente manera.\\[\\begin{equation}\n\\hat{\\beta}=N^{-1}\\left[\\sum_{=1}^{N}z_i^{'}x_i\\right]^{-1}\\left[\\sum_{=1}^{N}z_i^{'}y_i\\right]\n\\tag{3.2}\n\\end{equation}\\]Para simplificar (3.2) se puede nombrar Z juntando \\(z_i\\) N veces para crear una matriz de tamaño \\(NG\\times L\\). Lo mismo hacemos con X juntando \\(x_i\\) para obtener una de \\(NG\\times K\\) y Y obteniendo una \\(NG\\times 1\\). Obteniendo:\\[\\begin{equation}\n\\hat{\\beta}=[Z^{'}X]^{-1}[Z^{'}Y]\n\\end{equation}\\]Es importante tomar en cuenta cuando el caso en el que hay más ecuaciones lineales que coeficientes \\(\\beta\\); es decir, \\(L\\geq K\\). En estos casos es muy probrable que haya solución, por lo que mejor que se puede estimar es pones la ecuación (3.1), tan pequeña como sea posible. Por lo mismo el paso que nos lleva la ecuación (3.2), debe eliminarse \\(N^{-1}\\). El objetivo:\\[\\begin{equation}\n\\min_{\\beta} \\left[\\sum_{=1}^{N}z_i^{'}x_i\\beta\\right]^{-1}\\left[\\sum_{=1}^{N}z_i^{'}y_i\\beta\\right]\n\\tag{3.3}\n\\end{equation}\\]Así pues nombramos W como una matriz simétrica de \\(W\\times W\\) donde se genera la variable \\(b\\) que debemos minimizar que sustituye \\(\\beta\\) creando una función cuadrática en la ecuación (3.2).\n\\[\\begin{equation}\n\\min_{b}\\left[\\sum_{=1}^{N}z_i^{'}x_ib\\right]^{-1}\\left[\\sum_{=1}^{N}z_i^{'}y_ib\\right]\n\\tag{3.4}\n\\end{equation}\\]\\[\\begin{equation}\n\\therefore\\hat{\\beta}=[X^{'}Z\\hat{W}Z^{'}X]^{-1}[X^{'}Z\\hat{W}Z^{'}Y]\n\\end{equation}\\]Sin embargo, \\(X^{'}Z\\hat{W}Z^{'}X\\) debe ser singular para que haya una solución. Para esto se asume que \\(\\hat{W}\\) tiene un limite de probabilidad singular. Esto se describe como \\(\\hat{W}\\xrightarrow[]{p}W\\) y \\(N\\xrightarrow[]{}W\\infty\\) donde \\(W\\) es aleatorio, es una matriz positiva definida simétrica de \\(L\\times L\\).","code":""},{"path":"capital-asset-pricing-model-capm.html","id":"capital-asset-pricing-model-capm","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4 CAPITAL ASSET PRICING MODEL (CAPM)","text":"","code":""},{"path":"capital-asset-pricing-model-capm.html","id":"el-problema-3","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4.1 El problema","text":"Una vez que hemos establecido la manera en la que se pueden estimar algunos valores –como las regresiones lineales y el método de máxima verosimilitud–, además de la naturaleza de los retornos de algunos activos en el capítulo 4, es posible comenzar hablar de maneras en la que se pueden estimar los valores futuros de los rendimientos de activos y –de esta manera– poder tomar mejores decisiones de inversiones. Por ello, hablaremos del modelo de Capital Asset Pricing Model. El modelo es muy sencillo y pretende estimar su rentabilidad esperada en función del riesgo sistemático. Por lo mismo, en este modelo se utilizan los valores de los precios de los activos lo largo del tiempo y utiliza la intuición con la que derivamos la ecuación lineal con los Mínimos cuadrados ordinarios (MCO).En la ecuación (4.1)\\(R_{jt}\\) es el retorno del portafolio \\(j\\) en el tiempo \\(t\\)\\(R_{jt}\\) es el retorno del portafolio \\(j\\) en el tiempo \\(t\\)\\(R_{ft}\\) es el retorno de un bono sin riesgo gubernamental en un año. Parecido los CETES.\\(R_{ft}\\) es el retorno de un bono sin riesgo gubernamental en un año. Parecido los CETES.\\(R_{mt}\\) es el retorno en un portafolio de mercado.\\(R_{mt}\\) es el retorno en un portafolio de mercado.\\(u_{jt}\\) es el retorno en un portafolio de mercado.\\(u_{jt}\\) es el retorno en un portafolio de mercado.\\(\\alpha_{j},\\beta_j\\) son los coeficientes que queremos obtener.\\(\\alpha_{j},\\beta_j\\) son los coeficientes que queremos obtener.De esta manera, \\(\\alpha_j\\) es el coeficiente que más nos interesa debido que queremos ver si el activo supera o el index del mercado con base en el activo fijo.Si \\(\\alpha_j\\) es positivo entonces sabemos que el retorno tiene buenos rendimiendtos y uno negativo significa que . Por tanto \\(H_0:\\alpha_j=0\\)","code":""},{"path":"capital-asset-pricing-model-capm.html","id":"estimación-r-1","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4.2 Estimación R","text":"Para la estimación utilizaremos el paquete “BatchGetSymbols”. Este paquete nos permitirá descargar información acerca de la bolsa de valores internacional.","code":""},{"path":"capital-asset-pricing-model-capm.html","id":"estimación","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4.3 ESTIMACIÓN","text":"","code":""},{"path":"capital-asset-pricing-model-capm.html","id":"dependencias-1","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4.3.1 Dependencias","text":"","code":"\n#install.packages(\"pacman\")\n#pacman nos permite cargar varias librerias en una sola línea\nlibrary(pacman)\npacman::p_load(tidyverse,BatchGetSymbols,ggplot2,lubridate,readxl,tidyquant)"},{"path":"capital-asset-pricing-model-capm.html","id":"descarga-de-los-valores-1","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4.3.2 Descarga de los valores","text":"\nFigure 4.1: Relación de excesos de retornos entre AMZN y SP500\n\nFigure 4.2: Relación de excesos de retornos entre TSLA y SP500\nDe esta manera sabemos que el rendimiento de TSLA es mayor debido que el coeficiente \\(\\alpha=-2.9534\\), lo cual indica peores rendimientos al resto del SP500.","code":"\n#Primero determinamos el lapso de tiempo\npd<-as.Date(\"2021/09/18\") #primer fecha\npd\n#> [1] \"2021-09-18\"\nld<-as.Date(\"2022/09/18\") #última fecha\nld\n#> [1] \"2022-09-18\"\n#Intervalos de tiempo\nint<-\"monthly\"\n#Datos a elegir\ndt<-c(\"AMZN\")\ndt2<-c(\"TSLA\")\n#Descargando los valores\n?BatchGetSymbols()\ndata1<- BatchGetSymbols(tickers = dt,\n                       first.date = pd,\n                       last.date = ld,\n                       freq.data = int,\n                       do.cache = FALSE,\n                       thresh.bad.data = 0)\ndata2<- BatchGetSymbols(tickers = dt2,\n                       first.date = pd,\n                       last.date = ld,\n                       freq.data = int,\n                       do.cache = FALSE,\n                       thresh.bad.data = 0)\n\n#Generando data frame con los valores\ndata_precio_amzn<-data1$df.tickers\ncolnames(data_precio_amzn)\n#>  [1] \"ticker\"              \"ref.date\"           \n#>  [3] \"volume\"              \"price.open\"         \n#>  [5] \"price.high\"          \"price.low\"          \n#>  [7] \"price.close\"         \"price.adjusted\"     \n#>  [9] \"ret.adjusted.prices\" \"ret.closing.prices\"\ndata_precio_tls<-data2$df.tickers\ncolnames(data_precio_tls)\n#>  [1] \"ticker\"              \"ref.date\"           \n#>  [3] \"volume\"              \"price.open\"         \n#>  [5] \"price.high\"          \"price.low\"          \n#>  [7] \"price.close\"         \"price.adjusted\"     \n#>  [9] \"ret.adjusted.prices\" \"ret.closing.prices\"\n#necesitamos convertir la serie de tiempo de precios en retornos continuos compuestos de los precios de apertura\ndata_precio_amzn$ccrAMZN<-c(NA ,100*diff(log(data_precio_amzn$price.open)))#agregamos un valor NA al principio\ndata_precio_amzn$ccrAMZN#estos son los retornos\n#>  [1]          NA  -3.2011678   2.1889913   5.3061639\n#>  [5]  -5.6279333 -11.0646538   1.8052718   7.2089622\n#>  [9] -29.3475086  -0.1185366 -13.9945965  23.8807273\n#> [13]  -6.8696583\n\ndata_precio_tls$ccrTSLA<-c(NA ,100*diff(log(data_precio_tls$price.open)))#agregamos un valor NA al principio\ndata_precio_tls$ccrTSLA\n#>  [1]         NA   5.796888  38.591933   1.361865  -1.121972\n#>  [6] -20.478772  -7.264574  21.765521 -22.795320 -13.089771\n#> [11] -10.336735  28.307900 -10.009692\n#formateando por año y mes\ndata_precio_tls$ref.date=format(as.Date(data_precio_tls$ref.date), \"%m/%Y\")\ndata_precio_amzn$ref.date=format(as.Date(data_precio_amzn$ref.date), \"%m/%Y\")\n#Compararemos con los CETES\nCETES_sep2021_2022<-read_excel(\"BD/CETES-sep2021-2022.xlsx\", skip=17)\nhead(CETES_sep2021_2022)\n#> # A tibble: 6 × 2\n#>   Fecha               SF43936\n#>   <dttm>                <dbl>\n#> 1 2021-09-15 00:00:00    4.6 \n#> 2 2021-09-23 00:00:00    4.58\n#> 3 2021-09-30 00:00:00    4.69\n#> 4 2021-10-07 00:00:00    4.81\n#> 5 2021-10-14 00:00:00    4.79\n#> 6 2021-10-21 00:00:00    4.83\n#indice sp500\nSP500 <- read_csv(\"BD/Download Data - INDEX_US_S&P US_SPX.csv\")\nSP500$ccrSP500<-c(NA ,100*diff(log(SP500$Open)))\nnames(SP500)[1]<-paste('ref.date')\n#formateando por año y mes\n\n#cetes\ncete_1_año<-10.10#esto es el rendimiento a un año de un cete gubernamental seguro\n\n#Juntamos el df\nCAPM_2<-merge(data_precio_amzn, data_precio_tls, by = c('ref.date'))\nCAPM_4<-merge(SP500, CAPM_2, by = c('ref.date'))\nCAPM<-data.frame(CAPM_4)\n\n#exceso de retorno\nCAPM$excess_ret_AMZN<-CAPM$ccrAMZN-cete_1_año\nCAPM$excess_ret_SP500<-CAPM$ccrSP500-cete_1_año\nCAPM$excess_ret_TSLA<-CAPM$ccrTSLA-cete_1_año\n#relacion entre los excesos de demanda\nggplot(CAPM, aes(x=excess_ret_AMZN, y=excess_ret_SP500))+geom_point()+labs(title=\"Relación de excesos de retornos entre TSLA y AMZN\",y=\"Exceso de demanda de SP500\", x=\"Exceso de demanda de AMZN\")+theme_light()\n#> Warning: Removed 2 rows containing missing values\n#> (geom_point).\n#relacion entre los excesos de demanda\nggplot(CAPM, aes(x=excess_ret_TSLA, y=excess_ret_SP500))+geom_point()+labs(title=\"Relación de excesos de retornos entre TSLA y AMZN\",y=\"Exceso de demanda de SP500\", x=\"Exceso de demanda de TSLA\")+theme_light()\n#> Warning: Removed 2 rows containing missing values\n#> (geom_point).\n#veamos la regresion lineal\nCAPM_lr<-lm(excess_ret_TSLA~excess_ret_SP500,data = CAPM)\nsummary(CAPM_lr)\n#> \n#> Call:\n#> lm(formula = excess_ret_TSLA ~ excess_ret_SP500, data = CAPM)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -23.980 -13.391  -5.548  11.572  37.067 \n#> \n#> Coefficients:\n#>                  Estimate Std. Error t value Pr(>|t|)\n#> (Intercept)       -3.2334    11.8097  -0.274     0.79\n#> excess_ret_SP500   0.5379     1.0789   0.499     0.63\n#> \n#> Residual standard error: 20.88 on 9 degrees of freedom\n#>   (2 observations deleted due to missingness)\n#> Multiple R-squared:  0.02687,    Adjusted R-squared:  -0.08125 \n#> F-statistic: 0.2486 on 1 and 9 DF,  p-value: 0.6301\nalpha1<-coefficients(CAPM_lr)[1]\nalpha1<0\n#> (Intercept) \n#>        TRUE"},{"path":"capital-asset-pricing-model-capm.html","id":"ejercicio-compara-con-tsla-con-el-apple","chapter":"4 CAPITAL ASSET PRICING MODEL (CAPM)","heading":"4.4 Ejercicio Compara con TSLA con el APPLE","text":"","code":"\ndt3<-\"AAPL\"\ndata3<-BatchGetSymbols(tickers = dt3,\n                       first.date = pd,\n                       last.date = ld,\n                       freq.data = int,\n                       do.cache = FALSE,\n                       thresh.bad.data = 0)\n#> Warning: `BatchGetSymbols()` was deprecated in BatchGetSymbols 2.6.4.\n#> Please use `yfR::yf_get()` instead.\n#> 2022-05-01: Package BatchGetSymbols will soon be replaced by yfR. \n#> More details about the change is available at github <<www.github.com/msperlin/yfR>\n#> You can install yfR by executing:\n#> \n#> remotes::install_github('msperlin/yfR')\n#> \n#> Running BatchGetSymbols for:\n#>    tickers =AAPL\n#>    Downloading data for benchmark ticker\n#> ^GSPC | yahoo (1|1)\n#> AAPL | yahoo (1|1) - Got 100% of valid prices | Nice!\ndata_precio_AAPL<-data3$df.tickers\ncolnames(data_precio_AAPL)\n#>  [1] \"ticker\"              \"ref.date\"           \n#>  [3] \"volume\"              \"price.open\"         \n#>  [5] \"price.high\"          \"price.low\"          \n#>  [7] \"price.close\"         \"price.adjusted\"     \n#>  [9] \"ret.adjusted.prices\" \"ret.closing.prices\"\ndata_precio_AAPL$ccrAAPL<-c(NA ,100*diff(log(data_precio_AAPL$price.open)))#agregamos un valor NA al principio\ndata_precio_AAPL$ccrAAPL\n#>  [1]         NA  -1.330092   4.875668  11.698469   5.996413\n#>  [6]  -2.171531  -5.498712   5.510207 -10.483068  -4.442864\n#> [11]  -9.701946  16.851754  -2.751627\ndata_precio_AAPL$ref.date=format(as.Date(data_precio_AAPL$ref.date), \"%m/%Y\")\nCAPM_3<-merge(data_precio_AAPL, CAPM, by = c('ref.date'))\nCAPM_3$excess_ret_AAPL<-CAPM_3$ccrAAPL-cete_1_año\n#veamos la regresion lineal\nCAPM3_lr<-lm(excess_ret_AAPL~excess_ret_SP500,data = CAPM_3)\nsummary(CAPM3_lr)\n#> \n#> Call:\n#> lm(formula = excess_ret_AAPL ~ excess_ret_SP500, data = CAPM_3)\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -10.9038  -5.4365   0.4641   3.4629  14.1798 \n#> \n#> Coefficients:\n#>                  Estimate Std. Error t value Pr(>|t|)\n#> (Intercept)       -4.7542     4.9105  -0.968    0.358\n#> excess_ret_SP500   0.4663     0.4486   1.039    0.326\n#> \n#> Residual standard error: 8.682 on 9 degrees of freedom\n#>   (2 observations deleted due to missingness)\n#> Multiple R-squared:  0.1072, Adjusted R-squared:  0.007964 \n#> F-statistic:  1.08 on 1 and 9 DF,  p-value: 0.3258\nalpha2<-coefficients(CAPM3_lr)[1]\nalpha2<0\n#> (Intercept) \n#>        TRUE"}]
