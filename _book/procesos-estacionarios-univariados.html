<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Procesos estacionarios univariados | Diplomado de Econometría Financiera</title>
<meta name="author" content="Benjamin Oliva y Emiliano Pérez Caullieres">
<meta name="description" content="En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 6 Procesos estacionarios univariados | Diplomado de Econometría Financiera">
<meta property="og:type" content="book">
<meta property="og:description" content="En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Procesos estacionarios univariados | Diplomado de Econometría Financiera">
<meta name="twitter:description" content="En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Diplomado de Econometría Financiera</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Mínimos Cuadrados Ordinarios</a></li>
<li><a class="" href="m%C3%A1xima-verosimilitud.html"><span class="header-section-number">2</span> Máxima Verosimilitud</a></li>
<li><a class="" href="m%C3%A9todo-generalizado-de-momentos-mgm.html"><span class="header-section-number">3</span> Método Generalizado de Momentos (MGM)</a></li>
<li><a class="" href="capital-asset-pricing-model-capm.html"><span class="header-section-number">4</span> Capital Asset Pricing Model (CAPM)</a></li>
<li><a class="" href="estacionariedad.html"><span class="header-section-number">5</span> Estacionariedad</a></li>
<li><a class="active" href="procesos-estacionarios-univariados.html"><span class="header-section-number">6</span> Procesos estacionarios univariados</a></li>
<li><a class="" href="estacionalidad.html"><span class="header-section-number">7</span> Estacionalidad</a></li>
<li><a class="" href="raiz-unitaria.html"><span class="header-section-number">8</span> Raiz Unitaria</a></li>
<li><a class="" href="volatilidad-y-heterocedasticidad.html"><span class="header-section-number">9</span> Volatilidad y Heterocedasticidad</a></li>
<li><a class="" href="heterocedasticidad-condicionada.html"><span class="header-section-number">10</span> Heterocedasticidad condicionada</a></li>
<li><a class="" href="markov-switching-regime-model.html"><span class="header-section-number">11</span> Markov Switching Regime Model</a></li>
<li><a class="" href="setar-star-linear-test.html"><span class="header-section-number">12</span> SETAR-STAR-LINEAR-TEST</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="procesos-estacionarios-univariados" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Procesos estacionarios univariados<a class="anchor" aria-label="anchor" href="#procesos-estacionarios-univariados"><i class="fas fa-link"></i></a>
</h1>
<p>En este capítulo analizaremos el método o metodología de análisis de
series de tiempo propuesto por Box y Jenkins (1970). Los modelos
propuestos dentro de está metodología o conjunto de métodos se han
vuelto indispensables para efectos de realizar pronósticos de corto
plazo.</p>
<p>En este sentido, se analizarán los métodos más importantes en series de
tiempo: Autoregresivos (AR) y de Medias Móviles (MA). Asimismo, se
realizará un análisis de los procesos que resultan de la combinación de
ambos, conocida como ARMA, los cuales son más comúnmente usados para
realizar pronósticos.</p>
<div id="procesos-autoregresivos-ar" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Procesos Autoregresivos (AR)<a class="anchor" aria-label="anchor" href="#procesos-autoregresivos-ar"><i class="fas fa-link"></i></a>
</h2>
<p>Los procesos autoregresivos tienen su origen en el trabajo de Cochrane y
Orcutt de 1949, mediante el cual analizaron los residuales de una
regresión clásica como un proceso autoregresivo. Puede consultarse el
apéndice para la discusión del modelo de regresión clásica.</p>
<div id="ar1" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> AR(1)<a class="anchor" aria-label="anchor" href="#ar1"><i class="fas fa-link"></i></a>
</h3>
<p>Como primer caso analizaremos al proceso autoregresivo de primer orden,
<span class="math inline">\(AR(1)\)</span>, el cual podemos definir como una Ecuación Lineal en Diferencia
Estocástica de Primer Orden. Diremos que una Ecuación Lineal en
Diferencia de Primer Orden es estocástica si en su representación
analítica considera un componente estocástico como en la ecuación
<a href="procesos-estacionarios-univariados.html#eq:EDOEst1">(6.1)</a> descrita a continuación:</p>
<p><span class="math display" id="eq:EDOEst1">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + U_t
\tag{6.1}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_0\)</span> es un término constante, <span class="math inline">\(U_t\)</span> es un proceso estacionario,
con media cero (0), una varianza finita y constante (<span class="math inline">\(\sigma^2\)</span>) y una
covarianza que depende de la distancia entre <span class="math inline">\(t\)</span> y cualquier <span class="math inline">\(t-s\)</span>
(<span class="math inline">\(\gamma_s\)</span>)–que no depende de los valores pasados o futuros de la
variable–, <span class="math inline">\(X_0\)</span> es el valor inicial de <span class="math inline">\(X_t\)</span>. No obstante, en general
vamos a asumir que la covarianza será cero (0), por lo que tendremos un
proceso puramente aleatorio. Considerando la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOEst1">(6.1)</a> y
un proceso de sustitución sucesivo podemos establecer lo siguiente,
empezando con <span class="math inline">\(X_1\)</span>: <span class="math display">\[\begin{eqnarray*}
    X_{1} &amp; = &amp; a_0 + a_1 X_{0} + U_{1}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_2\)</span>: <span class="math display">\[\begin{eqnarray*}
X_{2} &amp; = &amp; a_0 + a_1 X_{1} + U_{2} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 X_{0} + U_{1}) + U_{2} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_3\)</span>: <span class="math display">\[\begin{eqnarray*}
X_{3} &amp; = &amp; a_0 + \alpha X_{2} + U_{3} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}) + U_{3} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 X_{0} + a_1^2 U_{1} + a_1 U_{2} + U_{3}
\end{eqnarray*}\]</span></p>
<p>Así, para cualquier <span class="math inline">\(X_t\)</span>, <span class="math inline">\(t = 1, 2, 3, \ldots\)</span>, obtendríamos:
<span class="math display" id="eq:EDOSSol">\[\begin{eqnarray}
X_{t} &amp; = &amp; a_0 + a_1 X_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 a_0 + \ldots + a_1^{t-2} a_0 + a_1^{t-1} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-2} U_{1} + \ldots + a_1 U_{t - 2} + U_{t - 1}) + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 a_0 + \ldots + a_1^{t-1} a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots + a_1^{t-1}) a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots + a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t}  \nonumber\\
    &amp; = &amp; \frac{1 - a_1^t}{1 - a_1} a_0 + a_1^{t} X_{0} + \sum^{t-1}_{j = 0} a_1^{j} U_{t - j}
    \tag{6.2}
\end{eqnarray}\]</span></p>
<p>De esta forma en la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOSSol">(6.2)</a> observamos un proceso que
es explicado por dos partes: una que depende del tiempo y otra que
depende de un proceso estocástico. Asimismo, debe notarse que la
condición de convergencia es idéntica que en el caso de ecuaciones en
diferencia estudiadas al inicio del curso: <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>, por
lo que cuando <span class="math inline">\(t \to \infty\)</span>, la expresión <a href="procesos-estacionarios-univariados.html#eq:EDOSSol">(6.2)</a> será la
siguiente:</p>
<p><span class="math display" id="eq:EDOSLP">\[\begin{equation}
    X_t = \frac{1}{1 - a_1} a_0 + \sum^{\infty}_{j = 0} a_1^{j} U_{t - j}
    \tag{6.3}
\end{equation}\]</span></p>
<p>Así, desaparece la parte dependiente del tiempo y únicamente prevalece
la parte que es dependiente del proceso estocástico. Esta es la solución
de largo plazo del proceso <span class="math inline">\(AR(1)\)</span>, la cual depende del proceso
estocástico. Notemos, además, que esta solución implica que la variable
o la serie de tiempo <span class="math inline">\(X_t\)</span> es tambien un proceso estocástico que hereda
las propiedades de <span class="math inline">\(U_t\)</span>. Así, <span class="math inline">\(X_t\)</span> es también un proceso estocástico
estacionario, como demostraremos más adelante.</p>
<p>Observemos que la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOSLP">(6.3)</a> se puede reescribir si
consideramos la formulación que en la literatura se denomina como la
descomposición de Wold, en la cual se define que es posible asumir que
<span class="math inline">\(\psi_j = a_1^j\)</span> y se considera el caso en el cual
<span class="math inline">\(\lvert a_1 \lvert&lt; 1\)</span>, de esta forma tendremos que por ejemplo cuando:
<span class="math display">\[\begin{equation*}
    \sum^{\infty}_{j = 0} \psi^2_j = \sum^{\infty}_{j = 0} a_1^{2j} = \frac{1}{1 - a_1^2}
\end{equation*}\]</span></p>
<p>Alternativamente y de forma similar a las ecuaciones en diferencia
estudiadas previamente podemos escribir el proceso <span class="math inline">\(AR(1)\)</span> mediante el
uso del operador rezago como:</p>
<p><span class="math display" id="eq:AR1">\[\begin{eqnarray}
    X_t &amp; = &amp; a_0 + a_1 L X_t + U_t \nonumber \\
    X_t - a_1 L X_t &amp; = &amp; a_0 + U_t \nonumber \\
    (1 - a_1 L) X_t &amp; = &amp; a_0 + U_t \nonumber \\
    X_t &amp; = &amp; \frac{a_0}{1 - a_1 L} + \frac{1}{1 - a_1 L} U_t
    \tag{6.4}
\end{eqnarray}\]</span></p>
<p>En esta última ecuación retomamos el siguiente término para reescribirlo
como:</p>
<p><span class="math display" id="eq:AR2">\[\begin{equation}
    \frac{1}{1 - a_1 L} = 1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots
    \tag{6.5}
\end{equation}\]</span></p>
<p>Tomando este resultado para sustituirlo en ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1">(6.4)</a>,
obtenemos la siguiente expresión:</p>
<p><span class="math display" id="eq:AR1Sol">\[\begin{eqnarray}
X_t &amp; = &amp; (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) a_0 + (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) U_t \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots) a_0 + U_t + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j}
    \tag{6.6}
\end{eqnarray}\]</span></p>
<p>Donde la condición de convergencia y estabilidad del proceso descrito en
esta ecuación es que <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>. Por lo que hemos
demostrado que mediante el uso del operador de rezago es posible llegar
al mismo resultado que obtuvimos mediante el procedimiento de
sustituciones iterativas.</p>
<p>La ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(6.6)</a> se puede interpretar como sigue. La
solución o trayectoria de equilibrio de un AR(1) se divide en dos
partes. La primera es una constante que depende de los valores de <span class="math inline">\(a_0\)</span>
y <span class="math inline">\(a_1\)</span>. La segunda parte es la suma ponderada de las desviaciones o
errores observados y acumulados en el tiempo hasta el momento <span class="math inline">\(t\)</span>.</p>
<p>Ahora obtendremos los momentos que describen a la serie de tiempo cuando
se trata de un porceso <span class="math inline">\(AR(1)\)</span>. Para ello debemos obtener la media, la
varianza y las covarianzas de <span class="math inline">\(X_t\)</span>. Para los siguientes resultados
debemos recordar y tener en mente que si <span class="math inline">\(U_t\)</span> es un proceso puramente
aleatorio, entonces:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\mathbb{E}[U_t] = 0\)</span> para todo <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(Var[U_t] = \sigma^2\)</span> para todo <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(Cov[U_t, U_s] = 0\)</span> para todo <span class="math inline">\(t \neq s\)</span>
</li>
</ol>
<p>Dicho lo anterior y partiendo de la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(6.6)</a>, el primer
momento o valor esperado de la serie de tiempo será el siguiente:
<span class="math display" id="eq:AR1m1">\[\begin{eqnarray}
\mathbb{E}[X_t] &amp; = &amp; \mathbb{E} \left[ \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} \right] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j \mathbb{E}[U_{t-j}] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} = \mu
    \tag{6.7}
\end{eqnarray}\]</span></p>
<p>Respecto de la varianza podemos escribir la siguiente expresión a partir
de la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(6.6)</a>:</p>
<p><span class="math display" id="eq:AR1Var">\[\begin{eqnarray}
Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right)^2 \right] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_{t} + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t} + a_1^2 U^2_{t-1} + a_1^4 U^2_{t-2} + a_1^6 U^2_{t-3} + \ldots \nonumber \\
    &amp;   &amp; + 2 a_1 U_t U_{t-1} + 2 a_1^2 U_t U_{t-2} + \ldots] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t}] + a_1^2 \mathbb{E}[U^2_{t-1}] + a_1^4 \mathbb{E}[U^2_{t-2}] + a_1^6 \mathbb{E}[U^2_{t-3}] + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 + a_1^2 \sigma^2 + a_1^4 \sigma^2 + a_1^6 \sigma^2 + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 (1 + a_1^2 + a_1^4 + a_1^6 + \ldots) \nonumber \\
    &amp; = &amp; \sigma^2 \frac{1}{1 - a_1^2} = \gamma(0)
    \tag{6.8}
\end{eqnarray}\]</span></p>
<p>Previo a analizar la covarianza de la serie recordemos que para el
proceso puramente aleatorio <span class="math inline">\(U_t\)</span> su varianza y covarianza puede verse
como <span class="math inline">\(\mathbb{E}[U_t, U_s] = \sigma^2\)</span>, para <span class="math inline">\(t = s\)</span>, y
<span class="math inline">\(\mathbb{E}[U_t, U_s] = 0\)</span>, para cualquier otro caso, respectivamente.</p>
<p>Dicho lo anterior, partiendo de la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(6.6)</a> la
covarianza de la serie estará dada por:</p>
<p><span class="math display" id="eq:AR1Cov">\[\begin{eqnarray}
Cov(X_t, X_{t-\tau}) &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t-\tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right) \right. \nonumber \\
    &amp;   &amp; \left. \times \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-\tau-j} - \frac{a_0}{1 - a_1} \right) \right] \nonumber \\
    &amp; = &amp; a_1^{\tau} \mathbb{E}[U^2_{t-\tau} + a_1 U^2_{t-\tau-1} + a_1^2 U^2_{t-\tau-2} + a_1^3 U^2_{t-\tau-3} + \ldots] \nonumber \\
    &amp; = &amp; a_1^{\tau} \sigma^2 \frac{1}{1 - a_1^2} = \gamma(\tau)
    \tag{6.9}
\end{eqnarray}\]</span></p>
<p>Notése que con estos resultados en las ecuaciones <a href="procesos-estacionarios-univariados.html#eq:AR1Var">(6.8)</a> y
<a href="procesos-estacionarios-univariados.html#eq:AR1Cov">(6.9)</a> podemos construir la función de autocorrelación teórica
como sigue:</p>
<p><span class="math display" id="eq:emi1">\[\begin{eqnarray}
\rho(\tau) &amp; = &amp; \frac{\gamma(\tau)}{\gamma(0)} \nonumber \\
    &amp; = &amp; a_1^\tau
    \tag{6.10}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>. Este último
resultado significa que cuando el proceso autoregresivo es de orden 1
(es decir, AR(1)) la función de autocorrelación teóricamente es igual al
parámetro <span class="math inline">\(a_1\)</span> elevado al número de rezagos considerados. No obstante,
note que esto no significa que la autocorrelación observada sea como lo
expresa en planteamiento anterior. Por el contrario, una observación
sencilla mostraría que la autocorrelación observada sería ligeramente
distinta a la autocorrelación teórica.</p>
<p>Ahora veámos algunos ejemplos. En el primer ejemplo simularemos una
serie y mostraremos el analísis de un proceso construído considerando un
proceso puramente aleatorio como componente <span class="math inline">\(U_t\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;El procedimiento e implementación del ejercicio
está en el archivo R denominado Clase 4 del repositorio de GitHub.&lt;/p&gt;"><sup>1</sup></a>
Por su parte, en un segundo ejemplo aplicaremos el análisis a una serie
de tiempo de una variable económica observada.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;El procedimiento e implementación del ejercicio
está en el archivo R denominado Clase 5 del repositorio de GitHub.&lt;/p&gt;"><sup>2</sup></a></p>
<p>Para el primer ejemplo consideremos un proceso dado por la forma de un
<span class="math inline">\(AR(1)\)</span> como en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1">(6.4)</a> cuya solución esta dada por la
ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(6.6)</a>. En especifico, supongamos que el término o
componente estocástico <span class="math inline">\(U_t\)</span> es una serie generada a partir de numeros
aleatorios de una función normal con media <span class="math inline">\(0\)</span> y desviación estándar
<span class="math inline">\(4\)</span>. Los detalles del proceso simulado se muestra en las siguientes
gráficas.</p>
<div id="ejemplo-ar1" class="section level4" number="6.1.1.1">
<h4>
<span class="header-section-number">6.1.1.1</span> EJEMPLO AR(1)<a class="anchor" aria-label="anchor" href="#ejemplo-ar1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"funciones/arroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"funciones/plot.armaroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"funciones/maroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parametros:</span></span>
<span><span class="va">a0</span> <span class="op">&lt;-</span> <span class="fl">5</span>; <span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.9</span>; <span class="va">X_0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a0</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a1</span><span class="op">)</span><span class="op">)</span>; <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre></div>
<p>Por lo tanto tenemos la serie de tiempo <span class="math inline">\(AR(1)\)</span>:
<span class="math display">\[ X_t= 5+0.9X_{t-1}+U_t\]</span></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Definimos un data frame para almacenar el proceso, agregamos una columna para el tiempo</span></span>
<span><span class="va">X_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Tiempo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  Parte estocastica de la serie de tiempo:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agregamos un término estocástico al data frame</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="cn">T</span><span class="op">+</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>En este caso el termino estocastico tiene una media de <span class="math inline">\(0\)</span> y una
desviación estándar constante <span class="math inline">\(\sigma^2=4\)</span></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agregamos columnas con NA's para un proceso teorico y uno real</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># La serie teórica inicia en un valor inicial X_0</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_0</span></span>
<span></span>
<span><span class="co"># La serie real inicia en un valor inicial X_0</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_0</span></span>
<span></span>
<span><span class="co"># Agregamos una columna para la función de Autocorrelación teórica:</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">rho</span> <span class="op">&lt;-</span><span class="cn">NA</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Real:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">a0</span> <span class="op">+</span> <span class="va">a1</span><span class="op">*</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Teórico:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">a1</span><span class="op">^</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Autocorrelación:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">a1</span><span class="op">^</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Tiempo        U_t      X_t     XR_t      rho</span></span>
<span><span class="co">#&gt; 1      0  2.3421153 50.00000 50.00000 0.900000</span></span>
<span><span class="co">#&gt; 2      1  2.8378641 52.10790 52.34212 0.810000</span></span>
<span><span class="co">#&gt; 3      2 -0.4372133 54.40657 54.94577 0.729000</span></span>
<span><span class="co">#&gt; 4      3 -1.8139887 54.08785 54.01398 0.656100</span></span>
<span><span class="co">#&gt; 5      4  2.4235498 52.89769 51.79859 0.590490</span></span>
<span><span class="co">#&gt; 6      5 -7.2718239 54.32877 54.04228 0.531441</span></span></code></pre></div>
<pre><code>#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2
#&gt; 3.4.0.
#&gt; ℹ Please use `linewidth` instead.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1Real"></span>
<img src="07-PE_Univariados_files/figure-html/GAR1Real-1.png" alt="AR(1) considerando $X_t=5+0.9X_{t-1}+U_t$ ; $X_0=50$ y que $U_t$~$N(0, 4)$ y que $U_t \sim \mathcal{N}(0, 4)$" width="100%"><p class="caption">
Figure 6.1: AR(1) considerando <span class="math inline">\(X_t=5+0.9X_{t-1}+U_t\)</span> ; <span class="math inline">\(X_0=50\)</span> y que <span class="math inline">\(U_t\)</span>~<span class="math inline">\(N(0, 4)\)</span> y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span>, y <span class="op">=</span> <span class="va">X_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"#0F531C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento del Proceso Teórico"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1Teo"></span>
<img src="07-PE_Univariados_files/figure-html/GAR1Teo-1.png" alt="$X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}$, y que $U_t \sim \mathcal{N}(0, 4)$}" width="100%"><p class="caption">
Figure 6.2: <span class="math inline">\(X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}\)</span>, y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>}
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span>, lag.max <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>    ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>    main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Real"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1FACr"></span>
<img src="07-PE_Univariados_files/figure-html/GAR1FACr-1.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)=\frac{\gamma(    au)}{\gamma(0)}$" width="100%"><p class="caption">
Figure 6.3: Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)=\frac{\gamma( au)}{\gamma(0)}\)</span>
</p>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>, names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, border<span class="op">=</span><span class="st">"blue"</span>, density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>, </span>
<span>        xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>        main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Teórica"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1FACt-1"></span>
<img src="07-PE_Univariados_files/figure-html/GAR1FACt-1.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)= a_1^\tau$" width="100%"><p class="caption">
Figure 6.4: Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)= a_1^\tau\)</span>
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span>, lag.max <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>    ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>    main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Real"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1FACt-2"></span>
<img src="07-PE_Univariados_files/figure-html/GAR1FACt-2.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)= a_1^\tau$" width="100%"><p class="caption">
Figure 6.5: Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)= a_1^\tau\)</span>
</p>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">XR_t</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">X_t</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"#0F531C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento de los Procesos Real y Teórico"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1Com"></span>
<img src="07-PE_Univariados_files/figure-html/GAR1Com-1.png" alt="AR(1) considerando en conjunto $X_t = 5 + 0.9 X_{t-1} + U_t$; $X_0 = 50$ y $X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}$, y que $U_t \sim \mathcal{N}(0, 4)$" width="100%"><p class="caption">
Figure 6.6: AR(1) considerando en conjunto <span class="math inline">\(X_t = 5 + 0.9 X_{t-1} + U_t\)</span>; <span class="math inline">\(X_0 = 50\)</span> y <span class="math inline">\(X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}\)</span>, y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>
</p>
</div>
<p>La Figura <a href="procesos-estacionarios-univariados.html#fig:GAR1Real">6.1</a> ilustra el comportamiento que se debería
observar en una serie considerando el procedimiento iterativo de
construcción. Por su parte, la Figura <a href="procesos-estacionarios-univariados.html#fig:GAR1Teo">6.2</a> ilustra el
proceso o trayectoria de la solución de la serie de tiempo. Finalmente,
las Figuras <a href="procesos-estacionarios-univariados.html#fig:GAR1FACr">6.3</a> y <a href="procesos-estacionarios-univariados.html#fig:GAR1FACr">6.3</a> muestran el
correlograma calculado considerando una función de autocorrelación
aplicada al porceso real y una función de autocorrelación aplicada al
proceso teórico, respectivamente.</p>
<p>Recordemos que una trayectoria de equilibrio o solución de un <span class="math inline">\(AR(1)\)</span> es
como se muestra en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(6.6)</a>. Así, nuestra serie
simulada cumple con la característica de que los errores son más
relevantes cuando la serie es corta. Por el contrario, los errores son
menos relevantes, cuando la serie es muy larga. La Figura
<a href="procesos-estacionarios-univariados.html#fig:GAR1Com">6.6</a> ilustra esta observación de la trayectoria de
equilibrio.</p>
</div>
</div>
<div id="ar2" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> AR(2)<a class="anchor" aria-label="anchor" href="#ar2"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez analizado el caso de <span class="math inline">\(AR(1)\)</span> analizaremos el caso del <span class="math inline">\(AR(2)\)</span>.
La ecuación generalizada del proceso autoregresivo de orden 2 (denotado
como <span class="math inline">\(AR(2)\)</span>) puede ser escrito como:</p>
<p><span class="math display" id="eq:AR2Eq">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + U_t
    \tag{6.11}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> denota un proceso puramente aleatorio con media cero (<span class="math inline">\(0\)</span>), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y autocovarianza cero (<span class="math inline">\(Cov(U_t, U_s) = 0\)</span>, con <span class="math inline">\(t \neq s\)</span>), y un parametro <span class="math inline">\(a_2 \neq 0\)</span>. Así, utilizando el operador rezago podemos reescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(6.11)</a> como:
<span class="math display">\[\begin{eqnarray*}
    X_t - a_1 X_{t-1} - a_2 X_{t-2} &amp; = &amp; a_0 + U_t \\
    (1 - a_1 L^1 - a_2 L^2) X_t &amp; = &amp; a_0 + U_t
\end{eqnarray*}\]</span></p>
<p>Donde, vamos a denotar a <span class="math inline">\(\alpha (L) = (1 - a_1 L^1 - a_2 L^2)\)</span>, y lo llamaremos como un polinomio que depende del operador rezago y que es distinto de cero. De esta forma podemos reescribir a la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(6.11)</a> como:
<span class="math display" id="eq:AR2Eq1">\[\begin{equation}
    \alpha(L) X_t = a_0 + U_t
    \tag{6.12}
\end{equation}\]</span></p>
<p>Ahora, supongamos que existe el inverso multiplicativo del polinomio <span class="math inline">\(\alpha(L)\)</span>, el cual será denotado como: <span class="math inline">\(\alpha^{-1}(L)\)</span> y cumple con que:
<span class="math display" id="eq:AR2Eq2">\[\begin{equation}
    \alpha^{-1}(L) \alpha(L) = 1   
      \tag{6.13}
\end{equation}\]</span></p>
<p>Así, podemos escribir la solución a la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(6.11)</a> como:
<span class="math display">\[\begin{equation}
    X_t = \alpha^{-1}(L) \delta + \alpha^{-1}(L) U_t
\end{equation}\]</span></p>
<p>Si utilizamos el hecho que <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede descomponer a través del procedimiento de Wold en un polinomio de forma similar el caso de <span class="math inline">\(AR(1)\)</span>, tenemos que:
<span class="math display" id="eq:AR2Eq3">\[\begin{equation}
    \alpha^{-1}(L) = \psi_0 + \psi_1 L + \psi_2 L^2 + \ldots
      \tag{6.14}
\end{equation}\]</span></p>
<p>Por lo tanto, el inverso multiplicativo <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede ver como:
<span class="math display" id="eq:InvAlpha">\[\begin{equation}
    1 = (1 - a_1 L^1 - a_2 L^2) (\psi_0 + \psi_1 L + \psi_2 L^2 + \ldots)
      \tag{6.15}
\end{equation}\]</span></p>
<p>Desarrollando la ecuación <a href="procesos-estacionarios-univariados.html#eq:InvAlpha">(6.15)</a> tenemos la sigueinte expresión:</p>
<p><span class="math display">\[\begin{eqnarray}
    1 &amp; = &amp; \psi_0 &amp; + &amp; \psi_1 L &amp; + &amp; \psi_2 L^2 &amp; + &amp; \psi_3 L^3 &amp; + &amp; \ldots \\
     &amp;  &amp;  &amp; - &amp; a_1 \psi_0 L &amp; - &amp; a_1 \psi_1 L^2 &amp; - &amp; a_1 \psi_2 L^3 &amp; - &amp; \ldots \\
    &amp; &amp;  &amp;  &amp;  &amp; - &amp; a_2 \psi_0 L^2  &amp; - &amp; a_2 \psi_1 L^3 &amp; - &amp; \ldots
\end{eqnarray}\]</span></p>
<p>Ahora, podemos agrupar todos los términos en función del exponente asociado al operador rezago <span class="math inline">\(L\)</span>. La siguiente es una solución partícular y es una de las múltiples que podrían existir que cumpla con la ecuación <a href="procesos-estacionarios-univariados.html#eq:InvAlpha">(6.15)</a>. Sin embargo, para efectos del análisis sólo necesitamos una de esas soluciones. Utilizaremos las siguientes condiciones que deben cumplirse en una de las posibles soluciones:</p>
<p><span class="math display">\[\begin{eqnarray}
    L^0 : &amp;   &amp; \Rightarrow &amp; \psi_0 = 1 \\
    L : &amp; \psi_1 - a_1 \psi_0 = 0 &amp; \Rightarrow &amp; \psi_1 = a_1$ \\
    L^2 : &amp; \psi_2 - a_1 \psi_1 - a_2 \psi_0 = 0 &amp; \Rightarrow &amp; \psi_2 = a^2_1 + a_2 \\
    L^3 : &amp; \psi_3 - a_1 \psi_2 - a_2 \psi_1 = 0 &amp; \Rightarrow &amp; \psi_3 = a^3_1 + 2 a_1 a_2$ \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots
\end{eqnarray}\]</span></p>
<p>De esta forma podemos observar que en el límite siempre obtendremos una ecuación del tipo <span class="math inline">\(\psi_j - a_1 \psi_{j-1} - a_2 \psi_{j-2} = 0\)</span> asociada a cada uno de los casos en que exista un <span class="math inline">\(L^j\)</span>, donde <span class="math inline">\(j \neq 0, 1\)</span>, y la cual siempre podremos resolver conociendo que las condiciones iniciales son: <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span>.</p>
<p>Así, de las relaciones antes mencionadas y considerando que <span class="math inline">\(\alpha^{-1} (L)\)</span> aplicada a una constante como <span class="math inline">\(a_0\)</span>, tendrá como resultado otra constante. De esta forma podemos escribir que la solución del proceso AR(2) en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(6.11)</a> será dada por una expresión como sigue:
<span class="math display" id="eq:AR2EqSol">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1 - a_2} + \sum^{\infty}_{j = 0} \psi_{t - j} U_{t - j}
    \tag{6.16}
\end{equation}\]</span></p>
<p>Donde todos los parametros <span class="math inline">\(\psi_i\)</span> está determinado por los parámtros <span class="math inline">\(a_0\)</span>, <span class="math inline">\(a_1\)</span> y <span class="math inline">\(a_2\)</span>. En particular, <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span> como describimos anteriormente. Al igual que en el caso del <span class="math inline">\(AR(1)\)</span>, en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2EqSol">(6.16)</a> las condiciones de estabilidad estarán dadas por las soluciones del siguiente polinomio característico:<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Note que raíces son equivalentes al inversio de las del polinomio dado por &lt;span class="math inline"&gt;\(\lambda^2 a_2 - \lambda a_1 - 1 = 0\)&lt;/span&gt;.&lt;/p&gt;'><sup>3</sup></a>
<span class="math display" id="eq:AR2EqSol1">\[\begin{equation}
    \lambda^2 - \lambda a_1 - a_2 = 0
    \tag{6.17}
\end{equation}\]</span></p>
<p>Así, la condición de estabilidad de la trayectoria es que <span class="math inline">\(\lvert\lambda_i\lvert &lt; 1\)</span>, para <span class="math inline">\(i = 1, 2\)</span>. Es decir, es necesario que cada una de las raíces sea, en valor absoluto, siempre menor que la unidad. Estas son las condiciones de estabilidad para el proceso <span class="math inline">\(AR(2)\)</span>.</p>
<p>Finalmente, al igual que en un <span class="math inline">\(AR(1)\)</span>, a continuación determinamos los momentos de una serie que sigue un proceso <span class="math inline">\(AR(2)\)</span>. Iniciamos con la determinación de la media de la serie:
<span class="math display" id="eq:AR2EqSol2">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_0}{1 - a_1 - a_2}
    \tag{6.18}
\end{equation}\]</span></p>
<p>Lo anterior es cierto puesto que <span class="math inline">\(\mathbb{E}[U_{t - i}] = 0\)</span>, para todo <span class="math inline">\(i = 0, 1, 2, \ldots\)</span>. Para determinar la varianza utilizaremos las siguientes relaciones basadas en el uso del valor esperado, varianza y covarianza de la serie. Adicionalmente, para simplificar el trabajo asumamos que <span class="math inline">\(a_0 = 0\)</span>, lo cual implica que <span class="math inline">\(\mu = 0\)</span>. Dicho lo anterior, partamos de:
<span class="math display" id="eq:AR2EqSol3">\[\begin{eqnarray}
    \mathbb{E}[X_t X_{t - \tau}] &amp; = &amp; \mathbb{E}[(a_1 X_{t-1} + a_2 X_{t-2} + U_t) X_{t - \tau}]\\
    &amp; = &amp; a_1 \mathbb{E}[X_{t - 1} X_{t - \tau}] + a_2 \mathbb{E}[X_{t - 2} X_{t - \tau}] + \mathbb{E}[U_{t} X_{t - \tau}]
    \tag{6.19}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, 3, \ldots\)</span> y que <span class="math inline">\(\mathbb{E}[U_{t} X_{t - \tau}] = 0\)</span> para todo <span class="math inline">\(\tau \neq 0\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Es fácil demostrar está afirmación, sólo requiere de desarrollar la expresión y utilizar el hecho de que &lt;span class="math inline"&gt;\(U_t\)&lt;/span&gt; es un proceso pueramente aleatorio, por lo que la covarianza es cero (0).&lt;/p&gt;'><sup>4</sup></a> Dicho esto, podemos derivar el valor del valor esperado para diferentes valores de <span class="math inline">\(\tau\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray}
    \tau = 0: &amp; \gamma(0) &amp; = &amp; \alpha_1 \gamma(1) + \alpha_2 \gamma(2) + \sigma^2 \\
    \tau = 1: &amp; \gamma(1) &amp; = &amp; \alpha_1 \gamma(0) + \alpha_2 \gamma(1) \\
    \tau = 2: &amp; \gamma(2) &amp; = &amp; \alpha_1 \gamma(1) + \alpha_2 \gamma(0) \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots
\end{eqnarray}\]</span></p>
<p>Donde debe ser claro que <span class="math inline">\(\mathbb{E}[(X_{t} - \mu)(X_{t - \tau} - \mu)] = \mathbb{E}[X_{t} X_{t - \tau}] = \gamma(\tau)\)</span>. Así, en general cuando <span class="math inline">\(\tau \neq 0\)</span>:
<span class="math display">\[\begin{equation}
    \gamma(\tau) = a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2)
\end{equation}\]</span></p>
<p>Realizando la sustitución recursiva y solucionando el sistema respectivo obtenemos que las varianza y covarianzas estaran determinadas por:
<span class="math display" id="eq:AR2EqSol5">\[\begin{equation}
    Var[X_t] = \gamma(0) = \frac{1 - a_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    \tag{6.20}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:AR2EqSol6">\[\begin{equation}
    \gamma(1) = \frac{a_1}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    \tag{6.21}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:AR2EqSol7">\[\begin{equation}
    \gamma(2) = \frac{a^2_1 + a_2 - a^2_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    \tag{6.22}
\end{equation}\]</span></p>
<p>Recordemos que las funciones de autocorrelación se obtienen de la división de cada unas de las funciones de covarianza (<span class="math inline">\(\gamma(\tau)\)</span>) por la varianza (<span class="math inline">\(\gamma(0)\)</span>). Así, podemos construir la siguiente expresión:
<span class="math display" id="eq:AR2EqSol8">\[\begin{equation}
    \rho(\tau) - a_1 \rho(\tau - 1) - a_2 \rho(\tau - 2) = 0
    \tag{6.23}
\end{equation}\]</span></p>
<p>Para el segundo ejemplo consideremos una aplicación a una serie de
tiempo en especifico:</p>
<div id="ejemplo-ar2" class="section level4" number="6.1.2.1">
<h4>
<span class="header-section-number">6.1.2.1</span> EJEMPLO AR(2)<a class="anchor" aria-label="anchor" href="#ejemplo-ar2"><i class="fas fa-link"></i></a>
</h4>
<p>Recordando el tema pasado y la serie en la que evaluamos los cambios de
precio del ACTIVO AMZN como si fueran retornos:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("pacman")</span></span>
<span><span class="co">#pacman nos permite cargar varias librerias en una sola línea</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman">pacman</a></span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,<span class="va">BatchGetSymbols</span>,<span class="va">ggplot2</span>,<span class="va">lubridate</span>,<span class="va">readxl</span>,<span class="va">forecast</span>,<span class="va">stats</span>,<span class="va">stargazer</span>,<span class="va">knitr</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Primero determinamos el lapso de tiempo</span></span>
<span><span class="va">pd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2002/9/01"</span><span class="op">)</span> <span class="co">#primer fecha</span></span>
<span><span class="va">pd</span></span>
<span><span class="co">#&gt; [1] "2002-09-01"</span></span>
<span><span class="co">#&gt; [1] "2021-09-18"</span></span>
<span><span class="va">ld</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2021/10/01"</span><span class="op">)</span><span class="co">#última fecha</span></span>
<span><span class="va">ld</span></span>
<span><span class="co">#&gt; [1] "2021-10-01"</span></span>
<span><span class="co">#Intervalos de tiempo</span></span>
<span><span class="va">int</span><span class="op">&lt;-</span><span class="st">"monthly"</span></span>
<span></span>
<span><span class="co">#Datos a elegir</span></span>
<span><span class="va">dt</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AMZN"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Descargando los valores</span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span> <span class="fu">BatchGetSymbols</span><span class="op">(</span>tickers <span class="op">=</span> <span class="va">dt</span>,</span>
<span>                       first.date <span class="op">=</span> <span class="va">pd</span>,</span>
<span>                       last.date <span class="op">=</span> <span class="va">ld</span>,</span>
<span>                       freq.data <span class="op">=</span> <span class="va">int</span>,</span>
<span>                       do.cache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       thresh.bad.data <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Generando data frame con los valores</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">&lt;-</span><span class="va">data1</span><span class="op">$</span><span class="va">df.tickers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "ticker"              "ref.date"           </span></span>
<span><span class="co">#&gt;  [3] "volume"              "price.open"         </span></span>
<span><span class="co">#&gt;  [5] "price.high"          "price.low"          </span></span>
<span><span class="co">#&gt;  [7] "price.close"         "price.adjusted"     </span></span>
<span><span class="co">#&gt;  [9] "ret.adjusted.prices" "ret.closing.prices"</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ret_20_amazn</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data_precio_amzn</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ref.date</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">price.open</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Precios de apertura de AMZN en los últimos 20 años"</span>,y<span class="op">=</span><span class="st">"Retornos"</span>, x<span class="op">=</span><span class="st">"Año"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ret_20_amazn</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20-1.png" alt="Serie de tiempo de los precios de apertura de año en los últimos 20 años" width="100%"><p class="caption">
Figure 5.5: Serie de tiempo de los precios de apertura de año en los últimos 20 años
</p>
</div>
<p>Primero que nada es importante cargar los datos a un objeto series de
tiempo. Esto nos lo permite la función ts(). Además debemos serciorarnos
de que los datos esten en orden cronológico.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_precio_amzn</span><span class="op">&lt;-</span><span class="va">data_precio_amzn</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">)</span><span class="co">#dado que ya estaba en orden cronológico nuestro df no cambia</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;   ticker ref.date     volume price…¹ price…² price…³ price…⁴</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;date&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 AMZN   2002-09-03   2.92e9   0.736   0.896   0.712   0.796</span></span>
<span><span class="co">#&gt; 2 AMZN   2002-10-01   4.07e9   0.812   1.01    0.800   0.968</span></span>
<span><span class="co">#&gt; 3 AMZN   2002-11-01   4.13e9   0.961   1.23    0.91    1.17 </span></span>
<span><span class="co">#&gt; 4 AMZN   2002-12-02   3.11e9   1.21    1.25    0.922   0.944</span></span>
<span><span class="co">#&gt; 5 AMZN   2003-01-02   3.38e9   0.960   1.16    0.928   1.09 </span></span>
<span><span class="co">#&gt; 6 AMZN   2003-02-03   2.32e9   1.10    1.12    0.980   1.10 </span></span>
<span><span class="co">#&gt; # … with 3 more variables: price.adjusted &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   ret.adjusted.prices &lt;dbl&gt;, ret.closing.prices &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   and abbreviated variable names ¹​price.open,</span></span>
<span><span class="co">#&gt; #   ²​price.high, ³​price.low, ⁴​price.close</span></span>
<span><span class="co">#hagamos el objeto ts</span></span>
<span><span class="va">price_amazn_ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">price.open</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">price_amazn_ts</span><span class="op">)</span><span class="co">#de esta manera podemos ver que se cargo bien debido a que es igual al ggplot</span></span></code></pre></div>
<div class="inline-figure"><img src="07-PE_Univariados_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Dado que queremos saber si existe un proceso <span class="math inline">\(AR(2)\)</span> en estos cambio
debemos calcularlo. Para ello utilizamos la función <span class="math inline">\(lm()\)</span> que realizará una regresión lineal y veremos la relación de los valores con sus valores pasados en <span class="math inline">\(t-2\)</span>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priceopen</span><span class="op">&lt;-</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">price.open</span></span>
<span><span class="va">priceopen_amazn</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">priceopen</span><span class="op">)</span></span>
<span><span class="va">lags</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">mat</span>,<span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">uno</span><span class="op">&lt;-</span><span class="va">mat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">mat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">mat</span>,<span class="fu">lag</span><span class="op">(</span><span class="va">uno</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df.lags</span><span class="op">&lt;-</span><span class="fu">lags</span><span class="op">(</span><span class="va">priceopen_amazn</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">ar2_amazn</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">V1</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">df.lags</span><span class="op">)</span></span></code></pre></div>
<p>Veamos la tabla de la regresión lineal:</p>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong>AR(2) de los precios de apertura de AMZN</strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
V1
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
V2
</td>
<td>
0.944<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.067)
</td>
</tr>
<tr>
<td style="text-align:left">
V3
</td>
<td>
0.076
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.068)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.217
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.342)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
227
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.991
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.991
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
4.202 (df = 224)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
12,966.920<sup>***</sup> (df = 2; 224) (p = 0.000)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:left">
(p&lt;0.1)=[*], (p&lt;0.05)=[**], (p&lt;0.01)=[***]
</td>
</tr>
</table></div>
<p>La tabla anterior claramente indica que <strong>hay una relación entre el valor del precio y sus valores anteriores en un proceso AR(2)</strong>.</p>
<p>Así pues es importante modificar la serie de tiempo para ilustrar como se puede controlar los efectos de los autoregresores <span class="math inline">\(AR(2)\)</span>. Para ello, utilizaremos la función <span class="math inline">\(arima()\)</span>. En “order” tenemos un vector <span class="math inline">\(c(p,d,q)\)</span> que corresponde <span class="math inline">\(p\)</span> a el grado de AR, <span class="math inline">\(d\)</span> el grado de diferención y <span class="math inline">\(q\)</span> el grado de MA que utilizaremos. El valor <span class="math inline">\(q\)</span> quedaráá en <span class="math inline">\(0\)</span> por ahora pero será analizado más adelante.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AR_price_amazn_ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="va">AR_price_amazn_pl</span><span class="op">&lt;-</span><span class="fu">Arima</span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></code></pre></div>
<p>Veamos si las raices inversas mantienen la estabilidad al ser menores a 1.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">AR_price_amazn_ts</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20root"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20root-1.png" alt="Raices AR(2) Inversas de la serie de tiempo" width="100%"><p class="caption">
Figure 6.7: Raices AR(2) Inversas de la serie de tiempo
</p>
</div>
<p>Claramente se puede en la Figura <a href="procesos-estacionarios-univariados.html#fig:amazn20root">6.7</a> ver que los valores de las raices inversas están dentro del circulo unitario y, por consiguiente son menores a 1. Ahora veamos como se ve la estimación ajustada AR(2) con el plot original.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">AR_price_amazn_pl</span><span class="op">$</span><span class="va">x</span>,col<span class="op">=</span><span class="st">"black"</span>, main <span class="op">=</span> <span class="st">"Diferencia entre la serie de tiempo original y AR(2)"</span>,xlab<span class="op">=</span><span class="st">"Tiempo"</span>,ylab<span class="op">=</span><span class="st">"Precio"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">AR_price_amazn_pl</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20AR2"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20AR2-1.png" alt="Diferencia entre la serie de tiempo original de precios de AMZN y su AR(2)" width="100%"><p class="caption">
Figure 6.8: Diferencia entre la serie de tiempo original de precios de AMZN y su AR(2)
</p>
</div>
<pre><code>#&gt; integer(0)</code></pre>
<p>Consecuentemente en la Figura <a href="procesos-estacionarios-univariados.html#fig:amazn20AR2">6.8</a> es posible ver la manera en la que se suaviza un poco la línea lo cual debe ayudarnos a hacer una mejor estimación. Ahora veamos <span class="math inline">\(AR(p)\)</span>.</p>
</div>
</div>
<div id="arp" class="section level3" number="6.1.3">
<h3>
<span class="header-section-number">6.1.3</span> AR(p)<a class="anchor" aria-label="anchor" href="#arp"><i class="fas fa-link"></i></a>
</h3>
<p>Veremos ahora una generalización de los procesos autoregresivos (AR). Esta generalización es conocida como un proceso <span class="math inline">\(AR(p)\)</span> y que puede ser descrito por la siguiente ecuación en diferencia estocástica:
<span class="math display" id="eq:ARpEq">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + a_p X_{t-p} + U_t
    \tag{6.24}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_p \neq 0\)</span>, y <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con media cero (0), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y covarianza cero (0). Usando el operador rezago, <span class="math inline">\(L^k\)</span>, para <span class="math inline">\(k = 0, 1, 2, \ldots, p\)</span>, obtenemos la siguiente expresión de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEq">(6.24)</a>:
<span class="math display" id="eq:ARpEq1">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p) X_t = a_0 + U_t
    \tag{6.25}
\end{equation}\]</span></p>
<p>Definamos el polinomio <span class="math inline">\(\alpha(L)\)</span> como:
<span class="math display" id="eq:PolA">\[\begin{equation}
    \alpha(L) = 1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p
    \tag{6.26}
\end{equation}\]</span></p>
<p>De forma similar que en los procesos <span class="math inline">\(AR(1)\)</span> y <span class="math inline">\(AR(2)\)</span>, las condiciones de estabilidad del proceso <span class="math inline">\(AR(p)\)</span> estarán dadas por la solución de la ecuación característica:
<span class="math display" id="eq:PolA1">\[\begin{equation}
    \lambda^p - a_1 \lambda^{p-1} - a_2 \lambda^{p-2} - a_3 \lambda^{p-3} - \ldots - a_p = 0
        \tag{6.27}
\end{equation}\]</span></p>
<p>Así, solo si el polinomio anterior tiene raíces cuyo valor absoluto sea menor a uno (<span class="math inline">\(\lvert\lambda_i\lvert &lt; 1\)</span>) y si <span class="math inline">\(1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p &lt; 1\)</span> podremos decir que el proceso es convergente y estable. Lo anterior significa que la ecuación <a href="procesos-estacionarios-univariados.html#eq:PolA">(6.26)</a> puede expresarse en términos de la descomposición de Wold o como la suma infinita de términos como:
<span class="math display" id="eq:PolA2">\[\begin{equation}
    \frac{1}{1 - a_1 L  - a_2 L^2 - a_3 L^3  - \ldots - a_p L^p} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
\tag{6.28}
\end{equation}\]</span></p>
<p>Donde, por construcción de <span class="math inline">\(\alpha(L) \alpha^{-1}(L) = 1\)</span> implica que <span class="math inline">\(\psi_0 = 1\)</span>. De forma similar a los proceso AR(1) y AR(2), es posible determinar el valor de los coefieentes <span class="math inline">\(\psi_j\)</span> en términos de los coefientes <span class="math inline">\(a_i\)</span>. Así, la solución del proceso <span class="math inline">\(AR(p)\)</span> estará dada por:
<span class="math display" id="eq:ARpEqSol">\[\begin{equation}
    X_t = \frac{a_0}{1 - a_1  - a_2 - a_3  - \ldots - a_p} + \sum^{\infty}_{j = 0} \psi_j U_{t-j}
    \tag{6.29}
\end{equation}\]</span></p>
<p>Considerando la solución de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEq">(6.24)</a> expresada en la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEqSol">(6.29)</a> podemos determinar los momentos del proceso y que estarán dados por una media como:
<span class="math display" id="eq:ARpEqSol1">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_o}{1 - a_1  - a_2 - a_3  - \ldots - a_p}
        \tag{6.30}
\end{equation}\]</span></p>
<p>Lo anterior, considerado que <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, para todo <span class="math inline">\(t\)</span>. Para determinar la varianza del proceso, sin pérdida de generalidad, podemos definir una ecuación: <span class="math inline">\(\gamma(\tau) = \mathbb{E}[X_{t - \tau} X_t]\)</span>, la cual (omitiendo la constante, ya que la correlación de una constante con cuaquier variable aleatoria que depende del tiempo es cero (0)) puede ser escrita como:
<span class="math display" id="eq:ARpEqSol2">\[\begin{equation}
    \gamma(\tau) = \mathbb{E}[(X_{t - \tau}) \cdot (a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + + a_p X_{t-p} + U_t)]
        \tag{6.31}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, \ldots, p\)</span> y <span class="math inline">\(a_0 = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>. De lo anterior obtenemos el siguiente conjunto de ecuaciones mediante sustituciones de los valores de <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; a_1 \gamma(1) + a_2 \gamma(2) + \ldots + a_p \gamma(p) + \sigma^2 \nonumber \\
    \gamma(1) &amp; = &amp; a_1 \gamma(0) + a_2 \gamma(1) + \ldots + a_p \gamma(p-1) \nonumber \\
    \vdots \nonumber \\
    \gamma(p) &amp; = &amp; a_1 \gamma(p-1) + a_2 \gamma(p-2) + \ldots + a_p \gamma(0) \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma, es fácil observar que la ecuación general para <span class="math inline">\(p &gt; 0\)</span> estará dada por:
<span class="math display" id="eq:Gammap">\[\begin{equation}
    \gamma(p) - a_1 \gamma(\tau - 1) - a_2 \gamma(\tau - 2) - \ldots - a_p \gamma(\tau - p) = 0
    \tag{6.32}
\end{equation}\]</span></p>
<p>Dividiendo la ecuación <a href="procesos-estacionarios-univariados.html#eq:Gammap">(6.32)</a> por <span class="math inline">\(\gamma(0)\)</span>, se obtiene la siguiente ecuación:
<span class="math display" id="eq:Gammap1">\[\begin{equation}
    \rho(p) - a_1 \rho(\tau - 1) + a_2 \rho(\tau - 2) + \ldots + a_p \rho(\tau - p) = 0
        \tag{6.33}
\end{equation}\]</span></p>
<p>Así, podemos escribir el siguiente sistema de ecuaciones:
<span class="math display">\[\begin{eqnarray}
    \rho(1) &amp; = &amp; a_1 + a_2 \rho(1) + a_3 \rho(2) + \ldots + a_p \rho(p-1) \nonumber \\
    \rho(2) &amp; = &amp; a_1 \rho(1) + a_2 + a_3 \rho(1) + \ldots + a_p \rho(p-2) \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \rho(p) &amp; = &amp; a_1 \rho(p-1) + a_2 \rho(p-2) + \ldots + a_p \nonumber
\end{eqnarray}\]</span></p>
<p>Lo anterior se puede expresar como un conjunto de vectores y matrices de la siguiente forma:
<span class="math display" id="eq:Gammap2">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(p)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(p - 1) \\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(p - 2) \\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(p - 3) \\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
        \rho(p - 1) &amp; \rho(p - 2) &amp; \ldots &amp; 1 \\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        a_1 \\
        a_2 \\
        a_3 \\
        \vdots \\
        a_p \\
    \end{array}
    \right]
\tag{6.34}
\end{equation}\]</span></p>
<p>De lo anterior podemos escribir la siguiente ecuación que es una forma alternativa para expresar los valores de los coefientes <span class="math inline">\(a_i\)</span> de la la solución del proceso <span class="math inline">\(AR(p)\)</span>:
<span class="math display" id="eq:Gammap3">\[\begin{equation}
    \mathbf{\rho} = \mathbf{R} \mathbf{a}
  \tag{6.35}
\end{equation}\]</span></p>
<p>Es decir, podemos obtener la siguiente expresión:
<span class="math display" id="eq:Gammap4">\[\begin{equation}
    \mathbf{a} = \mathbf{R}^{-1} \mathbf{\rho}
    \tag{6.36}
\end{equation}\]</span></p>
<div id="ejemplo-arp" class="section level4" number="6.1.3.1">
<h4>
<span class="header-section-number">6.1.3.1</span> Ejemplo AR(p)<a class="anchor" aria-label="anchor" href="#ejemplo-arp"><i class="fas fa-link"></i></a>
</h4>
<p>Veamos primero la función de autocorrelacion y el plot de los lags.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>, main<span class="op">=</span><span class="st">""</span>, lag.max <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pacfamzn"></span>
<img src="07-PE_Univariados_files/figure-html/pacfamzn-1.png" alt="Función de Autocorrelación parcial de la serie de tiempo de AMZN" width="100%"><p class="caption">
Figure 6.9: Función de Autocorrelación parcial de la serie de tiempo de AMZN
</p>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>, main<span class="op">=</span><span class="st">""</span>, lag.max <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:acfamzn"></span>
<img src="07-PE_Univariados_files/figure-html/acfamzn-1.png" alt="Función de Autocorrelación de la serie de tiempo de AMZN" width="100%"><p class="caption">
Figure 6.10: Función de Autocorrelación de la serie de tiempo de AMZN
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lag.plot.html">lag.plot</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>, main<span class="op">=</span><span class="st">""</span>, lags<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:LAGamazn20"></span>
<img src="07-PE_Univariados_files/figure-html/LAGamazn20-1.png" alt="5 plots de correlacion de los lags de la serie de tiempo de AMZN" width="100%"><p class="caption">
Figure 6.11: 5 plots de correlacion de los lags de la serie de tiempo de AMZN
</p>
</div>
<p>Dado que se puede ver en las Figuras <a href="procesos-estacionarios-univariados.html#fig:acfamzn">6.10</a>, <a href="procesos-estacionarios-univariados.html#fig:pacfamzn">6.9</a> y <a href="procesos-estacionarios-univariados.html#fig:LAGamazn20">6.11</a> que los valores de lag=1 tienen correlación resulta relevante hacer un AR(1), que corresponde a 1 años. Así pues:</p>
<p>AR:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AR_price_amazn_ts_1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="va">AR_price_amazn_pl_1</span><span class="op">&lt;-</span><span class="fu">Arima</span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></code></pre></div>
<p>Regresión lineal:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df.lags.1</span><span class="op">&lt;-</span><span class="fu">lags</span><span class="op">(</span><span class="va">priceopen_amazn</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ar20_amazn</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">V1</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">df.lags.1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong>AR(1) de los precios de apertura de AMZN</strong>
</caption>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
V1
</td>
<td>
229
</td>
<td>
31.913
</td>
<td>
45.104
</td>
<td>
0.736
</td>
<td>
174.820
</td>
</tr>
<tr>
<td style="text-align:left">
V2
</td>
<td>
228
</td>
<td>
31.286
</td>
<td>
44.193
</td>
<td>
0.736
</td>
<td>
174.479
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="6" style="text-align:left">
(p&lt;0.1)=[*], (p&lt;0.05)=[**], (p&lt;0.01)=[***]
</td>
</tr>
</table></div>
<p>Raices:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">AR_price_amazn_ts_1</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20root20"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20root20-1.png" alt="Raices AR(1) Inversas de la serie de tiempo" width="100%"><p class="caption">
Figure 6.12: Raices AR(1) Inversas de la serie de tiempo
</p>
</div>
<p>Plot:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">AR_price_amazn_pl_1</span><span class="op">$</span><span class="va">x</span>,col<span class="op">=</span><span class="st">"black"</span>, main <span class="op">=</span> <span class="st">"Diferencia entre la serie de tiempo original y AR(1)"</span>,xlab<span class="op">=</span><span class="st">"Tiempo"</span>,ylab<span class="op">=</span><span class="st">"Precio"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">AR_price_amazn_pl_1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20AR20"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20AR20-1.png" alt="Diferencia entre la serie de tiempo original de precios de AMZN y su AR(1)" width="100%"><p class="caption">
Figure 6.13: Diferencia entre la serie de tiempo original de precios de AMZN y su AR(1)
</p>
</div>
<pre><code>#&gt; integer(0)</code></pre>
</div>
</div>
</div>
<div id="función-de-autocorrelación-parcial" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Función de Autocorrelación Parcial<a class="anchor" aria-label="anchor" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><i class="fas fa-link"></i></a>
</h2>
<p>Ahora introduciremos el concepto de Función de Autocorrelación Parcial (PACF, por sus siglas en inglés). Primero, dadas las condiciones de estabilidad y de convergencia, si suponemos que un proceso AR, MA, ARMA o ARIMA tienen toda la información de los rezagos de la serie en conjunto y toda la información de los promedio móviles del término de error, resulta importante construir una métrica para distinguir el efecto de <span class="math inline">\(X_{t - \tau}\)</span> o el efecto de <span class="math inline">\(U_{t - \tau}\)</span> (para cualquier <span class="math inline">\(\tau\)</span>) sobre <span class="math inline">\(X_t\)</span> de forma individual.</p>
<p>La idea es construir una métrica de la correlación que existe entre las diferentes varibles aleatorias, si para tal efecto se ha controlado el efecto del resto de la información. Así, podemos definir la ecuación que puede responder a este planteamiento como:
<span class="math display" id="eq:PACFEq">\[\begin{equation}
    X_t = \phi_{k1} X_{t-1} + \phi_{k2} X_{t-2} + \ldots + \phi_{kk} X_{t-k} + U_t
    \tag{6.37}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\phi_{ki}\)</span> es el coeficiente de la variable dada con el rezago <span class="math inline">\(i\)</span> si el proceso tiene un órden <span class="math inline">\(k\)</span>. Así, los coeficientes <span class="math inline">\(\phi_{kk}\)</span> son los coeficientes de la autocorrelación parcial (considerando un proceso AR(k)). Observemos que la autocorrelaicón parcial mide la correlación entre <span class="math inline">\(X_t\)</span> y <span class="math inline">\(X_{t-k}\)</span> que se mantiene cuando el efecto de las variables <span class="math inline">\(X_{t-1}\)</span>, <span class="math inline">\(X_{t-2}\)</span>, <span class="math inline">\(\ldots\)</span> y <span class="math inline">\(X_{t-k-1}\)</span> en <span class="math inline">\(X_{t}\)</span> y <span class="math inline">\(X_{t-k}\)</span> ha sido eliminado.</p>
<p>Dada la expresión considerada en la ecuación <a href="procesos-estacionarios-univariados.html#eq:PACFEq">(6.37)</a>, podemos resolver el problema de establecer el valor de cada <span class="math inline">\(\phi_{ki}\)</span> mediante la solución del sistema que se representa en lo siguiente:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:foo1">Table 6.1: </span> Relación entre la Función de autocorrelación y la Función de autocorrelación parcial de una serie <span class="math inline">\(X_t\)</span>.</caption>
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">Modelo si:</th>
<th align="center">Función de autocorrelación</th>
<th align="center">Función de autocorrelación parcial</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(MA(q)\)</span></td>
<td align="center">Rompimientos en la función</td>
<td align="center">No hay rompimientos</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(AR(q)\)</span></td>
<td align="center">No hay rompimientos</td>
<td align="center">Rompimientos en la función</td>
</tr>
</tbody>
</table></div>
<p><span class="math display" id="eq:PACFEq1">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(k)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(k - 1)\\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(k - 2)\\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(k - 3)\\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots\\
        \rho(k - 1) &amp; \rho(k - 2) &amp; \ldots &amp; 1\\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        \phi_{k1} \\
        \phi_{k2} \\
        \phi_{k3} \\
        \vdots \\
        \phi_{kk} \\
    \end{array}
    \right]
    \tag{6.38}    
\end{equation}\]</span></p>
<p>Del cual se puede derivar una solución, resoviendo por el método de cramer, o cualquier otro método que consideremos y que permita calcular la solución de sistemas de ecuaciones.</p>
<p>Posterior al análisis analítico platearemos un enfoque para interpretar las funciones de autocorrelación y autocorrelación parcial. Este enfoque pretende aportar al principio de parcimonia, en el cual podemos identificar el número de parámetros que posiblemente puede describir mejor a la serie en un modelo ARMA(p, q).</p>
<p>En el Cuadro <a href="procesos-estacionarios-univariados.html#tab:foo1">6.1</a> se muestra un resumen de las caranterísticas que debemos observar para determinar el número de parámetros de cada uno de los componentes AR y MA. Lo anterior por observación de las funciones de autocorrelación y autocorrelación parcial. Este enfoque no es el más formal, más adelante implemtaremos uno más formal y que puede ser más claro de cómo determinar el númeto de parámetros.</p>
</div>
<div id="procesos-de-medias-móviles-ma" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Procesos de Medias Móviles (MA)<a class="anchor" aria-label="anchor" href="#procesos-de-medias-m%C3%B3viles-ma"><i class="fas fa-link"></i></a>
</h2>
<div id="ma1" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> MA(1)<a class="anchor" aria-label="anchor" href="#ma1"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez planteado el proceso generalizado de <span class="math inline">\(AR(p)\)</span>, iniciamos el planteamiento de los proceso de medias móviles, denotados como <span class="math inline">\(MA(q)\)</span>. Iniciemos con el planteamiento del proceso <span class="math inline">\(MA(1)\)</span>, que se puede escribir como una ecuación como la siguiente:
<span class="math display" id="eq:MA1Eq">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1}
    \tag{6.39}
\end{equation}\]</span></p>
<p>O como:
<span class="math display" id="eq:MA1Eq1">\[\begin{equation}
    X_t - \mu = (1 - b_1 L) U_{t}
    \tag{6.40}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, es decir, con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \sigma^2\)</span>, y <span class="math inline">\(Cov[U_t, U_s] = 0\)</span>. Así, un proceso <span class="math inline">\(MA(1)\)</span> puede verse como un proceso AR con una descomposición de Wold en la que <span class="math inline">\(\psi_0 = 1\)</span>, <span class="math inline">\(\psi_1 = - b_1\)</span> y <span class="math inline">\(\psi_j = 0\)</span> para todo <span class="math inline">\(j &gt; 1\)</span>.</p>
<p>Al igual que los procesos autoregresivos, determinaremos los momentos de un proceso <span class="math inline">\(MA(1)\)</span>. En el caso de la media observamos que será:
<span class="math display" id="eq:MA1Eq2">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t - 1}] \nonumber \\
    &amp; = &amp; \mu
    \tag{6.41}
\end{eqnarray}\]</span></p>
<p>Por su parte la varianza estará dada por:
<span class="math display" id="eq:MA1Eq3">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 - 2 b_1 U_t U_{t-1} + b_1^2 U_{t - 1}^2] \nonumber \\
    &amp; = &amp;\mathbb{E}[U_t^2] - 2 b_1 \mathbb{E}[U_t U_{t-1}] + b_1^2 \mathbb{E}[U_{t - 1}^2]] \nonumber \\
    &amp; = &amp; \sigma^2 + b_1^2 \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b_1^2) \sigma^2 = \gamma(0)
    \tag{6.42}
\end{eqnarray}\]</span></p>
<p>De esta forma, la varianza del proceso es constante en cualquier periodo <span class="math inline">\(t\)</span>. Para determinar la covarianza utilizaremos la siguiente ecuación:
<span class="math display" id="eq:MA1Cov">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + \tau} - \mu)] &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})(U_{t + \tau} - b_1 U_{t + \tau - 1})] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau} - b_1 U_t U_{t + \tau - 1} - b_1 U_{t - 1} U_{t + \tau} \nonumber \\
    &amp;   &amp; + b_1^2 U_{t - 1} U_{t + \tau - 1}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau}] - b_1 \mathbb{E}[U_t U_{t + \tau - 1}] \nonumber \\
    &amp;   &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t + \tau}] + b_1^2 \mathbb{E}[U_{t - 1} U_{t + \tau - 1}]
    \tag{6.43}
\end{eqnarray}\]</span></p>
<p>Si hacemos sustituciones de diferentes valores de <span class="math inline">\(\tau\)</span> en la ecuación <a href="procesos-estacionarios-univariados.html#eq:MA1Cov">(6.43)</a> notaremos que la covarianza será distinta de cero únicamente para el caso de <span class="math inline">\(\tau = 1, -1\)</span>. En ambos casos tendremos como resultado:
<span class="math display" id="eq:MA1Cov1">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + 1} - \mu)] &amp; = &amp; \mathbb{E}[(x_t - \mu)(x_{t - 1} - \mu)] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_t U_{t}] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t - 1}] \nonumber \\
    &amp; = &amp; - b_1^2 \sigma^2 = \gamma(1)
        \tag{6.44}
\end{eqnarray}\]</span></p>
<p>De esta forma tendremos que las funciones de autocorrelación estarán dadas por los siguientes casos:
<span class="math display">\[\begin{eqnarray}
    \rho(0) &amp; = &amp; 1 \nonumber \\
    \rho(1) &amp; = &amp; \frac{- b_1}{1 + b_1^2} \nonumber \\
    \rho(\tau) &amp; = &amp; 0 \text{ para todo } \tau &gt; 1 \nonumber
\end{eqnarray}\]</span></p>
<p>Ahora regresando a la ecuación <a href="procesos-estacionarios-univariados.html#eq:MA1Eq">(6.39)</a>,e su solución la podemos expresar como:
<span class="math display">\[\begin{eqnarray}
    U_ t &amp; = &amp; - \frac{\mu}{1 - b_1} + \frac{1}{1 - b_1 L} X_t \nonumber \\
    &amp; = &amp; - \frac{\mu}{1 - b_1} + X_t + b_1 X_{t-1} + b_1^2 X_{t-2} + \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>Donde la condición para que se cumpla esta ecuación es que <span class="math inline">\(\lvert b_1 \lvert&lt; 1\)</span>. La manera de interpretar esta condición es como una condición de estabilidad de la solución y cómo una condición de invertibilidad. Notemos que un <span class="math inline">\(MA(1)\)</span> (y en general un <span class="math inline">\(MA(q)\)</span>) es equivalente a un <span class="math inline">\(AR(\infty)\)</span>, es decir, cuando se invierte un MA se genera un AR con infinitos rezagos.</p>
<p>En esta sección no desarrollaremos un ejemplo, primero explicaremos en qué consiste una modelación del tipo <span class="math inline">\(MA(q)\)</span> y después platearemos un ejemplo en concreto.</p>
</div>
<div id="maq" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> MA(q)<a class="anchor" aria-label="anchor" href="#maq"><i class="fas fa-link"></i></a>
</h3>
<p>En general, el proceso de medias móviles de orden <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span>, puede ser escrito como:
<span class="math display" id="eq:MAqEQ">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}
    \tag{6.45}
\end{equation}\]</span></p>
<p>Podemos reescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:MAqEQ">(6.45)</a> utilizando el operador rezago, así tendrémos el proceso de <span class="math inline">\(MA(q)\)</span> como:
<span class="math display" id="eq:MAqRed">\[\begin{eqnarray}
    X_t - \mu &amp; = &amp; (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_{t} \nonumber \\
    X_t - \mu &amp; = &amp; \beta(L) U_t
    \tag{6.46}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \mathbb{E}[U_t^2] = 0\)</span> y <span class="math inline">\(Cov[U_t, U_s] = \mathbb{E}[U_t, U_s] = 0\)</span>, y <span class="math inline">\(\beta(L) = 1 - b_1 L - b_2 L^2 - \ldots - b_q L^q\)</span> es un polinomio del operador rezago <span class="math inline">\(L\)</span>. la ecuación <a href="procesos-estacionarios-univariados.html#eq:MAqRed">(6.46)</a> puede ser interpretada como un proceso <span class="math inline">\(AR(q)\)</span> sobre la serie <span class="math inline">\(U_t\)</span>.</p>
<p>Ahora determinemos los momentos de un proceso <span class="math inline">\(MA(q)\)</span>:
<span class="math display" id="eq:MAqRed1">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}] \nonumber \\
    &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t-1}] - b_2 \mathbb{E}[U_{t-2}] - \ldots - b_q \mathbb{E}[U_{t-q}] \nonumber \\
    &amp; = &amp; \mu
    \tag{6.47}
\end{eqnarray}\]</span></p>
<p>En el caso de la varianza tenemos que se puede expresar como:
<span class="math display" id="eq:MAqRed2">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 + b_1^2 U_{t-1}^2 + b_2^2 U_{t-2}^2 + \ldots + b_q^2 U_{t-q}^2 \nonumber \\
    &amp;   &amp; - 2 b_1 U_t U_{t - 1} - \ldots - 2 b_{q - 1} b_q U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2] + b_1^2 \mathbb{E}[U_{t-1}^2] + b_2^2 \mathbb{E}[U_{t-2}^2] + \ldots + b_q^2 \mathbb{E}[U_{t-q}^2] \nonumber \\
    &amp;   &amp; - 2 b_1 \mathbb{E}[U_t U_{t - 1}] - \ldots - 2 b_{q - 1} b_q \mathbb{E}[U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \sigma^2 + b^2_1 \sigma^2 + b^2_2 \sigma^2 + \ldots + b^2_q \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b^2_1 + b^2_2 + \ldots + b^2_q) \sigma^2
    \tag{6.48}
\end{eqnarray}\]</span></p>
<p>En el caso de las covarianzas podemos utilizar una idea similar al caso del <span class="math inline">\(AR(p)\)</span>, construir una expresión general para cualquier rezago <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    Cov[X_t, X_{t + \tau}] &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t + \tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}) \nonumber \\
    &amp;   &amp; (U_{t + \tau} - b_1 U_{t + \tau -1} - b_2 U_{t + \tau -2} - \ldots - b_q U_{t + \tau - q})] \nonumber
\end{eqnarray}\]</span></p>
<p>La expresión anterior se puede desarrollar para múltiples casos de <span class="math inline">\(\tau = 1, 2, \ldots, q\)</span>. De esta forma tenemos el siguiente sistema:
<span class="math display">\[\begin{eqnarray}
    \tau = 1 &amp; : &amp; \gamma(1) = (- b_1 + b_1 b_2 + \ldots + b_{q-1} b_q) \sigma^2 \nonumber \\
    \tau = 2 &amp; : &amp; \gamma(2) = (- b_2 + b_1 b_3 + \ldots + b_{q-2} b_q) \sigma^2 \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \tau = q &amp; : &amp; \gamma(q) = b_q \sigma^2 \nonumber
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\gamma(\tau) = 0\)</span> para todo <span class="math inline">\(\tau &gt; q\)</span>. Es decir, todas las autocovarianzas y autocorrelaciones con ordenes superiores a <span class="math inline">\(q\)</span> son cero (0). De esta forma, esta caracterítica teórica permite identificar el orden de <span class="math inline">\(MA(q)\)</span> visualizando la función de autocorrelación y verificando a partir de cual valor de rezago la autocorrelación es no significaiva.</p>
<p>Regresando al problema original que es el de determinar una solución para la eucación @ref(eq:MAq_EQ), tenemos que dicha solución estará dada por un <span class="math inline">\(AR(\infty)\)</span> en términos de <span class="math inline">\(U_t\)</span>:
<span class="math display" id="eq:MAqEqSol">\[\begin{eqnarray}
    U_t &amp; = &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \beta(L)^{-1} X_t \nonumber \\
    &amp;   &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \sum_{j = 0}^{\infty} c_j X_{t-j}
    \tag{6.49}
\end{eqnarray}\]</span></p>
<p>Donde se cumple que: <span class="math inline">\(1 = (1 - b_1 L^1 - b_2 L^2 - \ldots - b_q L^q)(1 - c_1 L - c_2 L^2 - \ldots)\)</span> y los coeficientes <span class="math inline">\(c_j\)</span> se pueden determinar por un método de coeficientes indeterminados y en términos de los valores <span class="math inline">\(b_i\)</span>. De igual forma que en el caso de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEq">(6.24)</a>, en la ecuación <a href="procesos-estacionarios-univariados.html#eq:MAqEqSol">(6.49)</a> se deben cumplir condiciones de estabilidad asociadas con las raíces del polinomio carácterististico dado por:
<span class="math display" id="eq:MAqEqSol2">\[\begin{equation}
    1 - b_1 x - b_2 x^2 - \ldots b_q x^q = 0
    \tag{6.50}
\end{equation}\]</span></p>
<p>El cual debe cumplir que <span class="math inline">\(\lvert x_i \lvert &lt; 1\)</span> y que <span class="math inline">\(1 - b_1 - b_2 - \ldots b_q &lt; 1\)</span>.</p>
<p>Ahora veamos el ejemplo.</p>
<div id="ejemplo-maq" class="section level4" number="6.3.2.1">
<h4>
<span class="header-section-number">6.3.2.1</span> Ejemplo MA(q)<a class="anchor" aria-label="anchor" href="#ejemplo-maq"><i class="fas fa-link"></i></a>
</h4>
<p>Cuando nos fijamos en las figuras <a href="procesos-estacionarios-univariados.html#fig:pacfamzn">6.9</a> y <a href="procesos-estacionarios-univariados.html#fig:acfamzn">6.10</a> es claro que hay un proceso MA(1). Es decir que picos de un año estan causando efectos en valores futuros. Así pues, escogemos un valor de <span class="math inline">\(q=1\)</span>.</p>
<p>MA:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MA_price_amazn_ts_1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="va">MA_price_amazn_pl_1</span><span class="op">&lt;-</span><span class="fu">Arima</span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></code></pre></div>
<p>Raices MA(1):</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">MA_price_amazn_ts_1</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20rootma11"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20rootma11-1.png" alt="Raices MA(1) Inversas de la serie de tiempo" width="100%"><p class="caption">
Figure 6.14: Raices MA(1) Inversas de la serie de tiempo
</p>
</div>
<p>Dado que el valor de la raiz inversa de MA(1) en la Figura <a href="procesos-estacionarios-univariados.html#fig:amazn20rootma11">6.14</a> sabemos que tenemos una serie convergente y estable.</p>
<p>Plot:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">MA_price_amazn_pl_1</span><span class="op">$</span><span class="va">x</span>,col<span class="op">=</span><span class="st">"black"</span>, main <span class="op">=</span> <span class="st">"Diferencia entre la serie de tiempo original y MA(1)"</span>,xlab<span class="op">=</span><span class="st">"Tiempo"</span>,ylab<span class="op">=</span><span class="st">"Precio"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">MA_price_amazn_pl_1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20AR1"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20AR1-1.png" alt="Diferencia entre la serie de tiempo original de precios de AMZN y su AR(1)" width="100%"><p class="caption">
Figure 6.15: Diferencia entre la serie de tiempo original de precios de AMZN y su AR(1)
</p>
</div>
<pre><code>#&gt; integer(0)</code></pre>
<p>En la Figura <a href="procesos-estacionarios-univariados.html#fig:amazn20AR1">6.15</a>, es muy fácil ver que los efectos de los picos son muy bajos ahora, lo cual nos permitirá hacer mejores estimaciones. <strong>Evidentemente querremos hacer el proceso AR(p) y MA(q) simultaneamente para obtener los mejores resultados.</strong></p>
</div>
</div>
</div>
<div id="procesos-armap-q-y-arimap-d-q" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Procesos ARMA(p, q) y ARIMA(p, d, q)<a class="anchor" aria-label="anchor" href="#procesos-armap-q-y-arimap-d-q"><i class="fas fa-link"></i></a>
</h2>
<p>Hemos establecido algunas relaciones las de los porcesos AR y los procesos MA, es decir, cómo un <span class="math inline">\(MA(q)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reexpresada como un <span class="math inline">\(AR(\infty)\)</span> de la serie <span class="math inline">\(U_t\)</span>, y viceversa un <span class="math inline">\(AR(p)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reeexpresada como un <span class="math inline">\(MA(\infty)\)</span>.</p>
<p>En este sentido, para cerrar esta sección veámos el caso de la especificación que conjunta ambos modelos en un modelo general conocido como <span class="math inline">\(ARMA(p, q)\)</span> o <span class="math inline">\(ARIMA(p, d, q)\)</span>. La diferencia entre el primero y el segundo es las veces que su tuvo que diferenciar la serie analizada, registro que se lleva en el índice <span class="math inline">\(d\)</span> de los paramétros dentro del concepto <span class="math inline">\(ARIMA(p, d, q)\)</span>. No obstante, en general nos referiremos al modelo como <span class="math inline">\(ARMA(p, q)\)</span> y dependerá del analista si modela la serie en niveles (por ejemplo, en logaritmos) o en diferencias logarítmicas (o diferencias sin logaritmos).</p>
<div id="arma1-1" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> ARMA(1, 1)<a class="anchor" aria-label="anchor" href="#arma1-1"><i class="fas fa-link"></i></a>
</h3>
<p>Dicho lo anterior vamos a empezar con el análisis de un <span class="math inline">\(ARMA(1, 1)\)</span>. Un proceso <span class="math inline">\(ARMA(1, 1)\)</span> puede verse como:
<span class="math display" id="eq:ARMA11Eq">\[\begin{equation}
    X_t = \delta + a_1 X_{t - 1} + U_t - b_1 U_{t - 1}
    \tag{6.51}
\end{equation}\]</span></p>
<p>Aplicando el operado rezago podemos rescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Eq">(6.51)</a> como:
<span class="math display" id="eq:ARMA11Eq1">\[\begin{equation}
    (1 - a_1 L) X_t = \delta + (1 - b_1 L) U_t
     \tag{6.52}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso pueramente aleatorio como en los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>, y <span class="math inline">\(X_t\)</span> puede ser una serie en niveles o en diferencias (ambas, en términos logarítmicos).</p>
<p>Así, el modelo <span class="math inline">\(ARIMA (p, q)\)</span> también tiene una representación de Wold que estará dada por las siguientes expresiones:
<span class="math display" id="eq:ARMA11Prev">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + \frac{1 - b_1 L}{1 - a_1 L} U_t
    \tag{6.53}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_1 \neq b_1\)</span>, puesto que en caso contrario <span class="math inline">\(X_t\)</span> sería un proceso puramente aleatorio con una media <span class="math inline">\(\mu = \frac{\delta}{1 - a_1}\)</span>. Así, podemos reescribir la descomposición de Wold a partir del componente de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Prev">(6.53)</a>
<span class="math display" id="eq:ARMA11EQWold">\[\begin{equation}
    \frac{1 - b_1 L}{1 - a_1 L} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
    \tag{6.54}
\end{equation}\]</span></p>
<p>Está ecuación es equivalente a la expresión:
<span class="math display">\[\begin{eqnarray}
    (1 - b_1 L) &amp; = &amp; (1 - a_1 L)(\psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots) \nonumber \\
    &amp; = &amp; \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots \nonumber \\
    &amp;   &amp; - a_1 \psi_0 L - a_1 \psi_1 L^2 - a_2 \psi_2 L^3 - a_1 \psi_3 L^4 - \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma podemos establecer el siguiente sistema de coeficientes indeterminados:
<span class="math display">\[\begin{eqnarray}
    L^0 : &amp;   &amp; \Rightarrow  &amp;  \psi_0 = 1  \\
     L^1 :  &amp;  \psi_1 - a_1 \psi_0 = - b_1  &amp;  \Rightarrow  &amp;  \psi_1 = a_1 - b_1  \\
     L^2 :  &amp;  \psi_2 - a_1 \psi_1 = 0  &amp;  \Rightarrow  &amp;  \psi_2 = a_1(a_1 - b_1)  \\
     L^3 :  &amp;  \psi_3 - a_1 \psi_2 = 0  &amp;  \Rightarrow  &amp;  \psi_3 = a^2_1(a_1 - b_1)  \\
     \vdots  &amp;  \vdots  &amp;  \vdots  &amp;  \vdots  \\
     L^j :  &amp;  \psi_j - a_1 \psi_{j - 1} = 0  &amp;  \Rightarrow  &amp;  \psi_j = a^{j - 1}_1(a_1 - b_1)
\end{eqnarray}\]</span></p>
<p>Así, la solución a la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Eq">(6.51)</a> estará dada por la siguiente generalización:
<span class="math display" id="eq:ARMA11Sol">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + U_t + (a_1 - b_1) U_{t - 1} + a_1(a_1 - b_1) U_{t - 2} + a_1^2(a_1 - b_1) U_{t - 3} + \ldots
\tag{6.55}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Sol">(6.55)</a> las condiciones de estabilidad y de invertibilidad del sistema (de un MA a un AR, y viceversa) estarán dadas por: <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span> y <span class="math inline">\(\lvert b_1 \lvert&lt; 1\)</span>. Adicionalmente, la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Sol">(6.55)</a> expresa cómo una serie que tiene un comportamiento <span class="math inline">\(ARMA(1, 1)\)</span> es equivalente a una serie modelada bajo un <span class="math inline">\(MA(\infty)\)</span>.</p>
<p>Al igual que en los demás modelos, ahora determinaremos los momentos del proceso <span class="math inline">\(ARMA(1, 1)\)</span>. La media estará dada por:
<span class="math display" id="eq:ARMA11Sol1">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\delta + a_1 X_{t-1} + U_t - b_1 U_{t-1}] \nonumber \\
    &amp; = &amp; \delta + a_1 \mathbb{E}[X_{t-1}] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1} \nonumber \\
    &amp; = &amp; \mu
    \tag{6.56}
\end{eqnarray}\]</span></p>
<p>Donde hemos utilizado que <span class="math inline">\(\mathbb{E}[X_t] = \mathbb{E}[X_{t-1}] = \mu\)</span>. Es decir, la media de un <span class="math inline">\(ARMA(1, 1)\)</span> es idéntica a la de un <span class="math inline">\(AR(1)\)</span>.</p>
<p>Para determinar la varianza tomaremos una estrategía similar a los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>. Por lo que para todo <span class="math inline">\(\tau \geq 0\)</span>, y suponiendo por simplicidad que <span class="math inline">\(\delta = 0\)</span> (lo que implica que <span class="math inline">\(\mu = 0\)</span>) tendremos:
<span class="math display" id="eq:ARMA11Cov">\[\begin{eqnarray}
    \mathbb{E}[X_{t-\tau} X_t] &amp; = &amp; \mathbb{E}[(X_{t-\tau}) \cdot (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \mathbb{E}[X_{t-\tau} X_{t-1}] + \mathbb{E}[X_{t-\tau} U_t] - b_1 \mathbb{E}[X_{t-\tau} U_{t-1}]
    \tag{6.57}
\end{eqnarray}\]</span></p>
<p>De la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Cov">(6.57)</a> podemos determinar una expresión para el caso de <span class="math inline">\(\tau = 0\)</span>:
<span class="math display" id="eq:ARMA11Cov1">\[\begin{eqnarray}
    \mathbb{E}[X_{t} X_t] &amp; = &amp; \gamma(0) \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \mathbb{E}[U_t X_t] - b_1 \mathbb{E}[X_t U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 + b_1 \mathbb{E}[U_{t-1} (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 - b_1 a_1 \sigma^2 + b_1 \sigma^2 \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + (1 - b_1 (a_1 - b_1)) \sigma^2
        \tag{6.58}
\end{eqnarray}\]</span></p>
<p>Para el caso en que <span class="math inline">\(\tau = 1\)</span>:
<span class="math display" id="eq:ARMA11Cov2">\[\begin{eqnarray}
    \mathbb{E}[X_{t-1} X_t] &amp; = &amp; \gamma(1) \nonumber \\
    &amp; = &amp; a_1 \gamma(0) + \mathbb{E}[X_{t-1} U_t] - b_1 \mathbb{E}[X_{t-1} U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(0) - b_1 \sigma^2
        \tag{6.59}
\end{eqnarray}\]</span></p>
<p>Estas últimas expresiones podemos resolverlas como sistema para determinar los siguientes valores:
<span class="math display" id="eq:ARMA11Cov3">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; \frac{1 + b_1^2 - 2 a_1 b_1}{1 - a_1^2} \sigma^2
    \tag{6.60}
\end{eqnarray}\]</span></p>
<p><span class="math display" id="eq:ARMA11Cov4">\[\begin{eqnarray}
    \gamma(1) &amp; = &amp; \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 - a_1^2} \sigma^2
    \tag{6.61}
\end{eqnarray}\]</span></p>
<p>En general para cualquier valor <span class="math inline">\(\tau \geq 2\)</span> tenemos que la autocovarianza y la función de autocorrelación serán:
<span class="math display" id="eq:ARMA11Cov5">\[\begin{eqnarray}
    \gamma(\tau) = a_1 \gamma(\tau - 1) \\
    \tag{6.62}
    \end{eqnarray}\]</span></p>
<p><span class="math display" id="eq:ARMA11Cov6">\[\begin{eqnarray}    
    \rho(\tau) = a_1 \rho(\tau - 1)
    \tag{6.63}
\end{eqnarray}\]</span></p>
<p>Por ejemplo, para el caso de <span class="math inline">\(\tau = 1\)</span> tendríamos:
<span class="math display" id="eq:ARMA11Cov7">\[\begin{equation}
    \rho(1) = \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 + b_1^2 - 2 a_1 b_1}
    \tag{6.64}
\end{equation}\]</span></p>
<p>De esta forma, la función de autocorrelación oscilará en razón de los valores que tome <span class="math inline">\(a_1\)</span> y <span class="math inline">\(b_1\)</span>.</p>
</div>
<div id="armap-q" class="section level3" number="6.4.2">
<h3>
<span class="header-section-number">6.4.2</span> ARMA(p, q)<a class="anchor" aria-label="anchor" href="#armap-q"><i class="fas fa-link"></i></a>
</h3>
<p>La especificación general de un <span class="math inline">\(ARMA(p, q)\)</span> (donde <span class="math inline">\(p, q \in \mathbb{N}\)</span>) puede ser descrita por la siguiente ecuación:
<span class="math display" id="eq:ARMApqEq">\[\begin{eqnarray}
    X_t &amp; = &amp; \delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q}
    \tag{6.65}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, y <span class="math inline">\(X_t\)</span> puede ser modelada en niveles o en diferencias (ya sea en logaritmos o sin transformación logarítmica).</p>
<p>Mediante el uso del operador rezago se puede escribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqEq">(6.65)</a> como:
<span class="math display" id="eq:ARMApqEQLag">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p) X_t = \delta + (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_t
    \tag{6.66}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqEQLag">(6.66)</a> definamos dos polinomios: <span class="math inline">\(\alpha(L) = (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p)\)</span> y <span class="math inline">\(\beta(L) = (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q)\)</span>. Así, podemos reescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqEQLag">(6.66)</a> como:
<span class="math display" id="eq:ARMApqEQLag1">\[\begin{equation}
    \alpha(L) X_t = \delta + \beta(L) U_t
    \tag{6.67}
\end{equation}\]</span></p>
<p>Asumiendo que existe el polinomio inverso tal que: <span class="math inline">\(\alpha(L)^{-1}\alpha(L) = 1\)</span>.La solución entonces puede ser escrita como:
<span class="math display" id="eq:ARMApqWold">\[\begin{eqnarray}
    X_t &amp; = &amp; \alpha(L)^{-1} \delta + \alpha(L)^{-1} \beta(L) U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + \frac{\beta(L)}{\alpha(L)} U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 L U_t + \psi_2 L^2 U_t + \ldots
    \tag{6.68}
\end{eqnarray}\]</span></p>
<p>Donde la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqWold">(6.68)</a> nos permite interpretar que un ARMA(p, q) se puede reexpresar e interpreetar como un <span class="math inline">\(MA(\infty)\)</span> y donde las condiciones para la estabilidad de la solución y la invertibilidad es que las ráices de los polinomios característicos <span class="math inline">\(\alpha(L)\)</span> y <span class="math inline">\(\beta(L)\)</span> son en valor absoluto menores a 1.</p>
<p>Adicionalmente, la fracción en la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqWold">(6.68)</a> se puede descomponer como en la forma de Wold:
<span class="math display" id="eq:ARMApqWold1">\[\begin{equation}
    \frac{\beta(L)}{\alpha(L)} = 1 + \psi_1 L + \psi_2 L^2 + \ldots
    \tag{6.69}
\end{equation}\]</span></p>
<p>Bajo los supuestos de estacionariedad del componente <span class="math inline">\(U_t\)</span>, los valores de la media y varianza de un proceso <span class="math inline">\(ARMA(p, q)\)</span> serán como describimos ahora. Para el caso de la media podemos partir de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqWold">(6.68)</a> para generar:
<span class="math display" id="eq:ARMApqWold2">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}\left[ \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 U_{t-1} + \psi_2 U_{t-2} + \ldots \right] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} \nonumber \\
    &amp; = &amp; \mu
    \tag{6.70}
\end{eqnarray}\]</span></p>
<p>Esta expresión indica que en general un proceso <span class="math inline">\(ARMA(p, q)\)</span> converge a una media idéntica a la de un porceso <span class="math inline">\(AR(p)\)</span>. Para determinar la varianza utilizaremos la misma estratégia que hemos utilizado para otros modelos <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>.</p>
<p>Sin pérdida de generalidad podemos asumir que <span class="math inline">\(\delta = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>, de lo que podemos establecer una expresión de autocovarianzas para cualquier valor <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span>:
<span class="math display" id="eq:ARMApqWold3">\[\begin{eqnarray}
    \gamma(\tau) &amp; = &amp; \mathbb{E}[X_{t-\tau} X_t] \nonumber \\
    &amp; = &amp; \mathbb{E}[X_{t-\tau} (\delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q})] \nonumber \\
    &amp; = &amp; a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2) + \ldots + a_p \gamma(\tau - p) \nonumber \\
    &amp;   &amp; + \mathbb{E}[X_{t-\tau} U_{t}] - b_1  \mathbb{E}[X_{t-\tau} U_{t-1}] - \ldots  - b_q  \mathbb{E}[X_{t-\tau} U_{t-q}]
    \tag{6.71}
\end{eqnarray}\]</span></p>
</div>
</div>
<div id="selección-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)<a class="anchor" aria-label="anchor" href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><i class="fas fa-link"></i></a>
</h2>
<p>Respecto de cómo estimar un proceso ARMA(p, q) –en general utilizaremos este modelo para discutir, pero lo planteado en esta sección es igualmente aplicable en cualquier otro caso como aquellos modelos que incluyen variables exogénas– existen diversas formas de estimar los paramétros <span class="math inline">\(a_i\)</span> y <span class="math inline">\(b_i\)</span>: i) por máxima verosimilitd y ii) por mínimos cuadrados órdinarios. El primer caso requiere que conozcamos la distribución del proceso aleatorio <span class="math inline">\(U_t\)</span>. El segundo, por el contrario, no requiere el mismo supuesto. No obstante, para el curso utilizaremos el método de máxima verosimilitud.</p>
<p>Otra duda que debe quedar hasta el momento es ¿cómo determinar el orden <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> del proceso ARMA(p, q)? La manera más convencional y formal que existe para tal efecto es utilizar los criterios de información. Así, el orden se elije de acuerdo a aquel críterio de información que resulta ser el mínimo. En el caso de <span class="math inline">\(d\)</span> se selecciona revisando la gráfica que parezca más estacionaria–más adelante mostraremos un proceso más formal para su selección.</p>
<p>Los criterios de información más comunes son los siguientes:</p>
<ol style="list-style-type: decimal">
<li><p>FPE (Final Prediction Error):
<span class="math display" id="eq:ls1">\[\begin{equation}
FPE = \frac{T+m}{T-m}\frac{1}{T}\sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2
\tag{6.72}
\end{equation}\]</span></p></li>
<li><p>Akaike:
<span class="math display" id="eq:ls2">\[\begin{equation}
AIC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2}{T}
     \tag{6.73}
\end{equation}\]</span></p></li>
<li><p>Schwarz:
<span class="math display" id="eq:ls3">\[\begin{equation}
SC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{ln(T)}{T}
   \tag{6.74}
\end{equation}\]</span></p></li>
<li><p>Hannan - Quinn:
<span class="math display" id="eq:ls4">\[\begin{equation}
HQ = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2 ln(ln(T))}{T}
   \tag{6.75}
\end{equation}\]</span></p></li>
</ol>
<p>Donde <span class="math inline">\(\hat{U}_t^{(p)}\)</span> son los residuales estimados mediante un proceso ARIMA y <span class="math inline">\(m\)</span> es el número de parametros estimados: <span class="math inline">\(m = p + q + 0 + 1\)</span> (ya que asumimos que <span class="math inline">\(d = 0\)</span>). Una propiedad que no se debe perder de vista es que los criterios de información cumplen la siguiente relación:
<span class="math display" id="eq:ls5">\[\begin{equation}
    orden(SC) \leq orden(HQ) \leq orden(AIC)
    \tag{6.76}
\end{equation}\]</span></p>
<p>Por esta razón, durante el curso solo utilizaremos el criterio se Akaike para determinar el orden óptimo del proceso ARMA, ya que ello garantiza el orden más grande posible.</p>
<p>Veamos el ejemplo.</p>
<div id="ejemplo-arma" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> Ejemplo ARMA<a class="anchor" aria-label="anchor" href="#ejemplo-arma"><i class="fas fa-link"></i></a>
</h3>
<p>Para este caso coemzaremos por agregar dos series de tiempo. Una correspone a una transformación logarítmica de los valores de los precios y, otra, corresponde la diferentcia logaritmica. Esto dado que:
<span class="math display">\[log(X_t)-log(X_{t-k})\sim\frac{X_t-X_{t-k}}{X_t}\]</span>.</p>
<p>Tranformacion de la serie original</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#original</span></span>
<span><span class="va">price_amazn_ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">price.open</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">09</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#logartimo</span></span>
<span><span class="va">lprice_amazn_ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">price.open</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#diferencias logaritmicas(cambio porcential)</span></span>
<span><span class="va">dlprice_amazn_ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">price.open</span><span class="op">)</span><span class="op">-</span><span class="fu">lag</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">price.open</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p>Las tres series</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Precios de apertura"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lprice_amazn_ts</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"LN Precios de apertura"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dlprice_amazn_ts</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN de precios de apertura"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="07-PE_Univariados_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;">
Veamos con detenimiento el pico de la gráfica original.</div>
<p>Es claro que este pico se da en 2020 desde junio hasta julio, probablemente causado por el aumento del uso en amzn durante la pandemia. Esos son outlier que debemos considerar. Por ello hay que marcarlos con una variable dummy.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Generamos el rango de tiempo</span></span>
<span><span class="va">junio2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-6-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">julio2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-07-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-07-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">agosto2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-08-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-08-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">sept2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-09-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-09-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">oct2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-10-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-10-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">nov2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-11-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-11-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">diciembre2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-12-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-12-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="co">#Añadimos valores 1 y 0 dependiento si estan dentro(1) o no</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">junio2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">junio2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">julio2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">julio2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">agosto2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">agosto2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">sept2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">sept2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">oct2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">oct2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">nov2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">nov2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">diciembre2020</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">ref.date</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">diciembre2020</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#ts</span></span>
<span><span class="va">junio2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">julio2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">julio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">agosto2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">agosto2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sep2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">sept2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">oct2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">oct2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nov2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">nov2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">diciembre2020ts</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">data_precio_amzn</span><span class="op">$</span><span class="va">diciembre2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#espacio de prediccion</span></span>
<span><span class="co">#dummies</span></span>
<span><span class="va">timepred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2022-10-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-10-10"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"month"</span><span class="op">)</span></span>
<span><span class="va">junio2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">julio2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">agosto2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">sep2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">oct2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">nov2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">diciembre2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">13</span><span class="op">)</span></span>
<span><span class="co">#data frame</span></span>
<span><span class="va">pred.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">timepred</span>,<span class="va">junio2020</span>,<span class="va">julio2020</span>, <span class="va">agosto2020</span>,<span class="va">sep2020</span>, <span class="va">oct2020</span>, <span class="va">nov2020</span>, <span class="va">diciembre2020</span><span class="op">)</span></span>
<span><span class="co">#dummies</span></span>
<span><span class="va">d.enero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">d.junio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-06-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-06-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">d.dic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span></span>
<span>  from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-01"</span><span class="op">)</span>,</span>
<span>  to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-29"</span><span class="op">)</span>,</span>
<span>  by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">pred.df</span><span class="op">$</span><span class="va">d.enero</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">timepred</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">d.enero</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">pred.df</span><span class="op">$</span><span class="va">d.junio</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">timepred</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">d.junio</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">pred.df</span><span class="op">$</span><span class="va">d.dic</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">timepred</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="va">d.dic</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#series de tiempo predictivas</span></span>
<span><span class="va">f.junio2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.agosto2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.sep2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.oct2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.nov2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.julio2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">junio2020</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.enero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">d.enero</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.junio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">d.junio</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f.diciembre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">pred.df</span><span class="op">$</span><span class="va">d.dic</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Como lo vimos en las figuras <a href="procesos-estacionarios-univariados.html#fig:pacfamzn">6.9</a> y <a href="procesos-estacionarios-univariados.html#fig:acfamzn">6.10</a>, es claro que debemos usar un valor <span class="math inline">\(q\)</span> de <span class="math inline">\(1\)</span> y <span class="math inline">\(p\)</span> de <span class="math inline">\(0\)</span>, esto debido a que cuando vemos <a href="procesos-estacionarios-univariados.html#fig:pacfamzn">6.9</a> no hay una correlación de ninguno de los valores. Asímismo, también necesitamos diferenciar, lo cual corresponde al valor <span class="math inline">\(d\)</span>. Así pues, dado que en las funciones de autocorrelacion solo vemos uno o dos picos arriba de la linea punteada azul, podemos asumir que el valor de diferenciación debe ser uno o dos, en este caso dos. Esto se debe seguir como regla de dedo, pero en general se debe usar el valor que minimice la desviacion estandar y también el que minimice AIC. Por tanto nuestro modelo debe ser <span class="math inline">\(arima(0,2,1)\)</span>.</p>
<p>Utilizamos la funcion “auto.arima” para confirmar que nuestra serie de tiempo deba ser <span class="math inline">\(arima(0,2,1)\)</span>, el arima que debos usar es aquel que minimize el indice AIC.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">auto.arima</span><span class="op">(</span><span class="va">price_amazn_ts</span>, trace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fitting models using approximations to speed things up...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ARIMA(2,2,2)(1,0,1)[12]                    : Inf</span></span>
<span><span class="co">#&gt;  ARIMA(0,2,0)                               : 1458.056</span></span>
<span><span class="co">#&gt;  ARIMA(1,2,0)(1,0,0)[12]                    : 1396.532</span></span>
<span><span class="co">#&gt;  ARIMA(0,2,1)(0,0,1)[12]                    : 1296.885</span></span>
<span><span class="co">#&gt;  ARIMA(0,2,1)                               : 1295.472</span></span>
<span><span class="co">#&gt;  ARIMA(0,2,1)(1,0,0)[12]                    : 1308.746</span></span>
<span><span class="co">#&gt;  ARIMA(0,2,1)(1,0,1)[12]                    : Inf</span></span>
<span><span class="co">#&gt;  ARIMA(1,2,1)                               : 1297.615</span></span>
<span><span class="co">#&gt;  ARIMA(0,2,2)                               : 1296.649</span></span>
<span><span class="co">#&gt;  ARIMA(1,2,0)                               : 1382.899</span></span>
<span><span class="co">#&gt;  ARIMA(1,2,2)                               : 1299.616</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Now re-fitting the best model(s) without approximations...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ARIMA(0,2,1)                               : 1305.63</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Best model: ARIMA(0,2,1)</span></span>
<span><span class="co">#&gt; Series: price_amazn_ts </span></span>
<span><span class="co">#&gt; ARIMA(0,2,1) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;           ma1</span></span>
<span><span class="co">#&gt;       -0.9716</span></span>
<span><span class="co">#&gt; s.e.   0.0140</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 = 17.95:  log likelihood = -650.79</span></span>
<span><span class="co">#&gt; AIC=1305.58   AICc=1305.63   BIC=1312.43</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#sin embargo hay que controlar con nuestra variable dummy</span></span>
<span><span class="va">ARIMA_price_amzn_ts_111</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                               method <span class="op">=</span> <span class="st">"ML"</span>,xreg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">julio2020ts</span>,<span class="va">agosto2020ts</span>,<span class="va">sep2020ts</span>,<span class="va">oct2020ts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ARIMA_price_amzn_pl_111</span><span class="op">&lt;-</span><span class="fu">Arima</span><span class="op">(</span><span class="va">price_amazn_ts</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                               method <span class="op">=</span> <span class="st">"ML"</span>,xreg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">julio2020ts</span>,<span class="va">agosto2020ts</span>,<span class="va">sep2020ts</span>,<span class="va">oct2020ts</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong>ARMA(0,2,1) de los precios de apertura de AMZN</strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
price_amazn_ts
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
ma1
</td>
<td>
-0.966<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.015)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
julio2020ts
</td>
<td>
9.383<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(3.220)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
agosto2020ts
</td>
<td>
24.377<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(3.946)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sep2020ts
</td>
<td>
33.689<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(3.946)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
oct2020ts
</td>
<td>
13.462<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(3.220)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
227
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-617.954
</td>
</tr>
<tr>
<td style="text-align:left">
sigma<sup>2</sup>
</td>
<td>
13.393
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
1,247.908
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td style="text-align:right">
(p&lt;0.1)=[*], (p&lt;0.05)=[**], (p&lt;0.01)=[***]
</td>
</tr>
</table></div>
<p>Raices MA(A):</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">ARIMA_price_amzn_ts_111</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:amazn20rootma1"></span>
<img src="07-PE_Univariados_files/figure-html/amazn20rootma1-1.png" alt="Raices ARMA(1) Inversas de la serie de tiempo" width="100%"><p class="caption">
Figure 6.16: Raices ARMA(1) Inversas de la serie de tiempo
</p>
</div>
<p>Dado esto, sabemos claramente que podremos analizar de mejor manera estos valores y, en consecuencia, hacer mejores estimaciones.</p>
</div>
<div id="pronósticos" class="section level3" number="6.5.2">
<h3>
<span class="header-section-number">6.5.2</span> Pronósticos<a class="anchor" aria-label="anchor" href="#pron%C3%B3sticos"><i class="fas fa-link"></i></a>
</h3>
<p>Para pronósticar el valor de la serie es necesario determinar cuál es el valor esperado de la serie en un momento <span class="math inline">\(t + \tau\)</span> condicional en que ésta se comporta como un <span class="math inline">\(AR(p)\)</span>, un <span class="math inline">\(MA(q)\)</span> o un <span class="math inline">\(ARMA(p, q)\)</span> y a que los valores antes de <span class="math inline">\(t\)</span> están dados. Por lo que el pronóstico de la serie estará dado por una expresión:</p>
<p><span class="math display" id="eq:ARMApqFor">\[\begin{eqnarray}
    \mathbb{E}_t[X_{t+\tau}] = \delta + a_1 \mathbb{E}_t[X_{t+\tau-1}] + a_2 \mathbb{E}_t[X_{t+\tau-2}] + \ldots + + a_p \mathbb{E}_t[X_{t+\tau-p}]
    \tag{6.77}
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ARIMA_price_amzn_ts_111_F</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ARIMA_price_amzn_ts_111</span>,n.ahead<span class="op">=</span><span class="fl">13</span>,newxreg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">f.julio2020</span>,<span class="va">f.agosto2020</span>,<span class="va">f.sep2020</span>,<span class="va">f.oct2020</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast.Arima</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="op">(</span><span class="va">ARIMA_price_amzn_pl_111</span>,h<span class="op">=</span><span class="fl">13</span>, xreg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">f.julio2020</span>,<span class="va">f.agosto2020</span>,<span class="va">f.sep2020</span>,<span class="va">f.oct2020</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Valores:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">forecast.Arima</span>,<span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Point Forecast
</th>
<th style="text-align:right;">
Lo 80
</th>
<th style="text-align:right;">
Hi 80
</th>
<th style="text-align:right;">
Lo 95
</th>
<th style="text-align:right;">
Hi 95
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Oct 2021
</td>
<td style="text-align:right;">
177.2339
</td>
<td style="text-align:right;">
172.4914
</td>
<td style="text-align:right;">
181.9763
</td>
<td style="text-align:right;">
169.9809
</td>
<td style="text-align:right;">
184.4869
</td>
</tr>
<tr>
<td style="text-align:left;">
Nov 2021
</td>
<td style="text-align:right;">
179.6477
</td>
<td style="text-align:right;">
172.8267
</td>
<td style="text-align:right;">
186.4688
</td>
<td style="text-align:right;">
169.2158
</td>
<td style="text-align:right;">
190.0796
</td>
</tr>
<tr>
<td style="text-align:left;">
Dec 2021
</td>
<td style="text-align:right;">
182.0616
</td>
<td style="text-align:right;">
173.5670
</td>
<td style="text-align:right;">
190.5562
</td>
<td style="text-align:right;">
169.0702
</td>
<td style="text-align:right;">
195.0530
</td>
</tr>
<tr>
<td style="text-align:left;">
Jan 2022
</td>
<td style="text-align:right;">
184.4754
</td>
<td style="text-align:right;">
174.5036
</td>
<td style="text-align:right;">
194.4473
</td>
<td style="text-align:right;">
169.2248
</td>
<td style="text-align:right;">
199.7261
</td>
</tr>
<tr>
<td style="text-align:left;">
Feb 2022
</td>
<td style="text-align:right;">
186.8893
</td>
<td style="text-align:right;">
175.5573
</td>
<td style="text-align:right;">
198.2213
</td>
<td style="text-align:right;">
169.5584
</td>
<td style="text-align:right;">
204.2202
</td>
</tr>
<tr>
<td style="text-align:left;">
Mar 2022
</td>
<td style="text-align:right;">
189.3032
</td>
<td style="text-align:right;">
176.6880
</td>
<td style="text-align:right;">
201.9183
</td>
<td style="text-align:right;">
170.0099
</td>
<td style="text-align:right;">
208.5964
</td>
</tr>
<tr>
<td style="text-align:left;">
Apr 2022
</td>
<td style="text-align:right;">
191.7170
</td>
<td style="text-align:right;">
177.8725
</td>
<td style="text-align:right;">
205.5615
</td>
<td style="text-align:right;">
170.5436
</td>
<td style="text-align:right;">
212.8904
</td>
</tr>
<tr>
<td style="text-align:left;">
May 2022
</td>
<td style="text-align:right;">
194.1309
</td>
<td style="text-align:right;">
179.0958
</td>
<td style="text-align:right;">
209.1659
</td>
<td style="text-align:right;">
171.1368
</td>
<td style="text-align:right;">
217.1250
</td>
</tr>
<tr>
<td style="text-align:left;">
Jun 2022
</td>
<td style="text-align:right;">
196.5447
</td>
<td style="text-align:right;">
180.3479
</td>
<td style="text-align:right;">
212.7415
</td>
<td style="text-align:right;">
171.7738
</td>
<td style="text-align:right;">
221.3156
</td>
</tr>
<tr>
<td style="text-align:left;">
Jul 2022
</td>
<td style="text-align:right;">
198.9586
</td>
<td style="text-align:right;">
181.6215
</td>
<td style="text-align:right;">
216.2957
</td>
<td style="text-align:right;">
172.4437
</td>
<td style="text-align:right;">
225.4735
</td>
</tr>
<tr>
<td style="text-align:left;">
Aug 2022
</td>
<td style="text-align:right;">
201.3724
</td>
<td style="text-align:right;">
182.9111
</td>
<td style="text-align:right;">
219.8338
</td>
<td style="text-align:right;">
173.1382
</td>
<td style="text-align:right;">
229.6067
</td>
</tr>
<tr>
<td style="text-align:left;">
Sep 2022
</td>
<td style="text-align:right;">
203.7863
</td>
<td style="text-align:right;">
184.2127
</td>
<td style="text-align:right;">
223.3599
</td>
<td style="text-align:right;">
173.8511
</td>
<td style="text-align:right;">
233.7216
</td>
</tr>
<tr>
<td style="text-align:left;">
Oct 2022
</td>
<td style="text-align:right;">
206.2002
</td>
<td style="text-align:right;">
185.5232
</td>
<td style="text-align:right;">
226.8772
</td>
<td style="text-align:right;">
174.5774
</td>
<td style="text-align:right;">
237.8229
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">forecast.Arima</span>, main <span class="op">=</span><span class="st">"Forecast ARIMA(0,2,1) de los precios de AMZN"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:predarima111"></span>
<img src="07-PE_Univariados_files/figure-html/predarima111-1.png" alt="Predicción de $Arima(1,1,1)$" width="100%"><p class="caption">
Figure 6.17: Predicción de <span class="math inline">\(Arima(1,1,1)\)</span>
</p>
</div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="estacionariedad.html"><span class="header-section-number">5</span> Estacionariedad</a></div>
<div class="next"><a href="estacionalidad.html"><span class="header-section-number">7</span> Estacionalidad</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#procesos-estacionarios-univariados"><span class="header-section-number">6</span> Procesos estacionarios univariados</a></li>
<li>
<a class="nav-link" href="#procesos-autoregresivos-ar"><span class="header-section-number">6.1</span> Procesos Autoregresivos (AR)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ar1"><span class="header-section-number">6.1.1</span> AR(1)</a></li>
<li><a class="nav-link" href="#ar2"><span class="header-section-number">6.1.2</span> AR(2)</a></li>
<li><a class="nav-link" href="#arp"><span class="header-section-number">6.1.3</span> AR(p)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><span class="header-section-number">6.2</span> Función de Autocorrelación Parcial</a></li>
<li>
<a class="nav-link" href="#procesos-de-medias-m%C3%B3viles-ma"><span class="header-section-number">6.3</span> Procesos de Medias Móviles (MA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ma1"><span class="header-section-number">6.3.1</span> MA(1)</a></li>
<li><a class="nav-link" href="#maq"><span class="header-section-number">6.3.2</span> MA(q)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#procesos-armap-q-y-arimap-d-q"><span class="header-section-number">6.4</span> Procesos ARMA(p, q) y ARIMA(p, d, q)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#arma1-1"><span class="header-section-number">6.4.1</span> ARMA(1, 1)</a></li>
<li><a class="nav-link" href="#armap-q"><span class="header-section-number">6.4.2</span> ARMA(p, q)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><span class="header-section-number">6.5</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ejemplo-arma"><span class="header-section-number">6.5.1</span> Ejemplo ARMA</a></li>
<li><a class="nav-link" href="#pron%C3%B3sticos"><span class="header-section-number">6.5.2</span> Pronósticos</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/07-PE_Univariados.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/07-PE_Univariados.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Diplomado de Econometría Financiera</strong>" was written by Benjamin Oliva y Emiliano Pérez Caullieres. It was last built on 2022-11-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
